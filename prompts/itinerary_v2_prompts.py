"""
V2 Itinerary Generation Prompts

This module contains all prompt templates used by ItineraryGeneratorService2.
Prompts are organized as functions that accept request data and return formatted strings.

Version: 2.0
Last Updated: 2025-11-25
"""

from typing import List, Dict
from datetime import timedelta
from models.schemas2 import ItineraryRequest2, PlaceTag


def create_main_prompt_v2(request: ItineraryRequest2) -> str:
    """
    Generate the main V2 itinerary prompt for Gemini.

    This is the primary prompt used in the first generation attempt.

    Args:
        request: ItineraryRequest2 object containing all user inputs

    Returns:
        str: Fully formatted prompt ready for Gemini API

    Example:
        >>> request = ItineraryRequest2(days=3, ...)
        >>> prompt = create_main_prompt_v2(request)
        >>> response = gemini_client.generate(prompt)
    """
    # Format date information with weekdays
    date_info = _format_date_info(request)

    # Format input sections
    chat_text = _format_chat(request.chat)
    rule_text = _format_rules(request.rule)
    must_visit_text = _format_must_visit(request.must_visit)
    accommodation_text = _format_accommodation(request.places)
    places_text = _format_places(request.places)

    # Assemble the complete prompt
    prompt = f"""## ë‹¹ì‹ ì˜ ì—­í• 
ë‹¹ì‹ ì€ ì—¬í–‰ ì¼ì • ìƒì„± ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
ì‚¬ìš©ìžê°€ ë‚˜ëˆˆ ì±„íŒ… ë‚´ìš©ì„ ë¶„ì„í•˜ê³ , ì œê³µëœ ìž¥ì†Œ ëª©ë¡ê³¼ í•¨ê»˜ ìµœì ì˜ ì—¬í–‰ ì¼ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.

## ìž…ë ¥ ë°ì´í„°

### ì—¬í–‰ êµ­ê°€/ë„ì‹œ
{request.country}

### ì—¬í–‰ ì¸ì›
{request.members}ëª…

### ì—¬í–‰ ê¸°ê°„
{chr(10).join(date_info)}
ì´ {request.days}ì¼

### ê³ ë ¤ ì¤‘ì¸ ìž¥ì†Œ ëª©ë¡ (places)
ê° ìž¥ì†Œì—ëŠ” ì‚¬ìš©ìžê°€ ì§€ì •í•œ place_tagê°€ í¬í•¨ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.
{places_text}

### ì‚¬ìš©ìž ëŒ€í™” ë‚´ìš© (chat)
{chat_text}

### ë°˜ë“œì‹œ ì§€ì¼œì•¼ í•  ê·œì¹™ (rule)
{rule_text}

### í•„ìˆ˜ ë°©ë¬¸ ìž¥ì†Œ (must_visit)
{must_visit_text}

### ìˆ™ì†Œ (accommodation)
{accommodation_text}

# ì—¬í–‰ ì¼ì • ìƒì„± ì‹œìŠ¤í…œ - 5ë‹¨ê³„ ìš°ì„ ìˆœìœ„

## ìš°ì„ ìˆœìœ„ ì²´ê³„

### ðŸ”´ Priority 1: ì‚¬ìš©ìž ìš”ì²­ì‚¬í•­ ì¤€ìˆ˜ (MANDATORY - 100%)
- ì—¬í–‰ ì¼ìˆ˜(days) ì •í™•ížˆ ì¤€ìˆ˜
- ì—¬í–‰ ì‹œìž‘ì¼(start_date) ì •í™•ížˆ ì¤€ìˆ˜
- í•„ìˆ˜ ë°©ë¬¸ ìž¥ì†Œ(must_visit) 100% í¬í•¨
- ê·œì¹™(rule) 100% ì¤€ìˆ˜
- ëŒ€í™” ë‚´ìš©(chat) ë¶„ì„í•˜ì—¬ ì‚¬ìš©ìž ì·¨í–¥ ë°˜ì˜
- í›„ë³´ ìž¥ì†Œ(places) ìš°ì„  ì„ íƒ, ë¶€ì¡± ì‹œ Geminiê°€ ì¶”ì²œ

### ðŸŸ  Priority 2: ìš´ì˜ì‹œê°„ ì¤€ìˆ˜ (HIGHLY RECOMMENDED - 90%+)
- ëª¨ë“  ìž¥ì†ŒëŠ” ìš´ì˜ì‹œê°„ ë‚´ì—ë§Œ ë°©ë¬¸
- ìš´ì˜ì‹œê°„ ì—†ëŠ” ìš”ì¼ ë°©ë¬¸ ê¸ˆì§€
- ì´ë™ì‹œê°„ ê³ ë ¤í•˜ì—¬ ìš´ì˜ì‹œê°„ ë‚´ ë„ì°©
- Google Maps Grounding Tool í™œìš© í•„ìˆ˜
- êµí†µìˆ˜ë‹¨ chatì—ì„œ ì¶”ë¡  (ê¸°ë³¸ê°’: transit)

### ðŸŸ¡ Priority 3: ë§¥ë½ì  ìˆœì„œ ë°°ì¹˜ (RECOMMENDED - 80%+)
- ì²´ë¥˜ì‹œê°„ ì ì ˆì„±
- ë°©ë¬¸ ì‹œê°„ëŒ€ ì ì ˆì„± (ì‹ì‚¬ì‹œê°„ ê³ ë ¤)
- ìžì—°ìŠ¤ëŸ¬ìš´ í™œë™ íë¦„

### ðŸŸ¢ Priority 4: íš¨ìœ¨ì ì¸ ë™ì„  (OPTIMIZATION - Best Effort)
- ì´ë™ì‹œê°„ ìµœì†Œí™”
- íš¨ìœ¨ì ì¸ ë™ì„  êµ¬ì„±

### ðŸ”µ Priority 5: í‰ì  ìš°ì„  ì„ íƒ (NICE TO HAVE - Best Effort)
- í‰ì  ë†’ì€ ìž¥ì†Œ ë°©ë¬¸

**í•µì‹¬ ì›ì¹™**: Priority Nì€ Priority N-1ì„ ì ˆëŒ€ ìœ„ë°˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

---

## ðŸ”´ Priority 1: ì‚¬ìš©ìž ìš”ì²­ì‚¬í•­ ì¤€ìˆ˜ (MANDATORY - 100%)

ì´ ìš°ì„ ìˆœìœ„ì˜ ìš”êµ¬ì‚¬í•­ë“¤ì€ **ì ˆëŒ€ì ìœ¼ë¡œ ì¤€ìˆ˜**í•´ì•¼ í•˜ë©°, ì–´ë–¤ ìƒí™©ì—ì„œë„ ìœ„ë°˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### 1-A. ì—¬í–‰ ì¼ìˆ˜(days) ë° ì‹œìž‘ì¼(start_date) ì •í™•ížˆ ì¤€ìˆ˜

**í•„ìˆ˜ ì‚¬í•­**:
- ìš”ì²­ëœ `days` ê°’ê³¼ ì •í™•ížˆ ë™ì¼í•œ ê°œìˆ˜ì˜ day ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤
- ê° dayì˜ ë‚ ì§œëŠ” `start_date`ë¶€í„° ì‹œìž‘í•˜ì—¬ í•˜ë£¨ì”© ì¦ê°€í•´ì•¼ í•©ë‹ˆë‹¤
- day ë²ˆí˜¸ëŠ” 1ë¶€í„° ì‹œìž‘í•˜ì—¬ 1ì”© ì¦ê°€í•©ë‹ˆë‹¤

**ê²€ì¦ ë°©ë²•**:
- len(itinerary) == days
- day.day: 1, 2, 3, ..., days
- day.date: start_date, start_date+1ì¼, ..., start_date+(days-1)ì¼

**ì˜ˆì‹œ**:
- ìš”ì²­: days=3, start_date=2025-10-15
- ìƒì„±: Day 1 (2025-10-15), Day 2 (2025-10-16), Day 3 (2025-10-17)

**ê¸ˆì§€ì‚¬í•­**:
- âŒ ì¼ìˆ˜ë¥¼ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì´ëŠ” ê²ƒ ì ˆëŒ€ ë¶ˆê°€
- âŒ ë‚ ì§œë¥¼ ê±´ë„ˆë›°ëŠ” ê²ƒ ì ˆëŒ€ ë¶ˆê°€

### 1-B. í•„ìˆ˜ ë°©ë¬¸ ìž¥ì†Œ(must_visit) 100% í¬í•¨

**í•„ìˆ˜ ì‚¬í•­**:
- `must_visit`ì— ëª…ì‹œëœ ëª¨ë“  ìž¥ì†ŒëŠ” ë°˜ë“œì‹œ ì¼ì •ì— í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
- ì¼ì •ì´ ë¶€ì¡±í•˜ë©´ ë‹¤ë¥¸ ì¶”ì²œ ìž¥ì†Œë¥¼ ì œê±°í•˜ë”ë¼ë„ must_visitëŠ” ë°˜ë“œì‹œ ìœ ì§€í•˜ì„¸ìš”
- ìš´ì˜ì‹œê°„ì´ ë§žì§€ ì•Šìœ¼ë©´ ë‹¤ë¥¸ ë‚ ì§œë¡œ ì´ë™í•˜ì„¸ìš”

**ê²€ì¦ ë°©ë²•**:
- must_visitì˜ ê° ìž¥ì†Œëª…ì´ itineraryì˜ ì–´ëŠ dayì—ë“  display_nameìœ¼ë¡œ ì¡´ìž¬í•´ì•¼ í•¨

**ì ˆëŒ€ ê·œì¹™**:
- ì–´ë–¤ ìƒí™©ì—ì„œë„ must_visit ìž¥ì†Œë¥¼ ìƒëžµí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤

### 1-C. ê·œì¹™(rule) 100% ì¤€ìˆ˜

**í•„ìˆ˜ ì‚¬í•­**:
- `rule`ì— ëª…ì‹œëœ ëª¨ë“  í•­ëª©ì€ ë°˜ë“œì‹œ ì¼ì •ì— ì •í™•ížˆ ë°˜ì˜ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
- ê·œì¹™ì´ ëª¨í˜¸í•˜ë©´ ì‚¬ìš©ìžì˜ ì˜ë„ë¥¼ ìµœëŒ€í•œ ì¶”ë¡ í•˜ì—¬ ì ìš©í•˜ì„¸ìš”

**ê·œì¹™ í•´ì„ ë° ì ìš©**:
- **ì‹œê°„ ì œì•½**: "11ì‹œ ê¸°ìƒ" â†’ ì²« ë°©ë¬¸(arrival)ì€ 11:00 ì´í›„
- **í™œë™ ìš”êµ¬**: "ì ì‹¬ì€ í˜„ì§€ ë§›ì§‘ì—ì„œ" â†’ ì ì‹¬ì‹œê°„(12:00-14:00)ì— RESTAURANT ë°©ë¬¸
- **ìž¥ì†Œ ìš°ì„ ìˆœìœ„**: "ë‘˜ì§¸ë‚ ì€ ìœ ë‹ˆë²„ì„¤ í•˜ë£¨ ì¢…ì¼" â†’ Day 2ëŠ” ìœ ë‹ˆë²„ì„¤ë§Œ í¬í•¨
- **ì´ë™ ì œì•½**: "ë§ˆì§€ë§‰ë‚  ê³µí•­ìœ¼ë¡œ ì§í–‰" â†’ ë§ˆì§€ë§‰ë‚ ì€ ìˆ™ì†Œ ëŒ€ì‹  ê³µí•­ìœ¼ë¡œ ì¢…ë£Œ

**ìš°ì„ ìˆœìœ„**: ê·œì¹™(rule) > ìˆ™ì†Œ ì™•ë³µ > ê¸°ë³¸ íŒ¨í„´

### 1-D. ëŒ€í™” ë‚´ìš©(chat) ë¶„ì„ ë° ì‚¬ìš©ìž ì·¨í–¥ ë°˜ì˜

**í•„ìˆ˜ ì‚¬í•­**:
- ì±„íŒ… ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ ì—¬í–‰ ìŠ¤íƒ€ì¼, ì„ í˜¸ë„, íŒ¨í„´ì„ íŒŒì•…í•˜ì„¸ìš”
- ì—¬í–‰ ì˜ë„ì™€ êµ¬ì²´ì ì¸ ìš”êµ¬ì‚¬í•­ì„ ì¼ì •ì— ë°˜ì˜í•˜ì„¸ìš”

**ë¶„ì„ í•­ëª©**:
1. **ì—¬í–‰ ìŠ¤íƒ€ì¼ íŒŒì•…**:
   - "ì—¬ìœ ë¡­ê²Œ", "ëŠê¸‹í•˜ê²Œ" â†’ ì²´ë¥˜ì‹œê°„ ê¸¸ê²Œ, ì´ë™ ì ê²Œ
   - "ì•Œì°¨ê²Œ", "ë§Žì´ ë³´ê³  ì‹¶ì–´" â†’ ë°©ë¬¸ ìž¥ì†Œ ë§Žê²Œ, ì´ë™ì‹œê°„ ìµœì†Œí™”
   - "ë¡œì»¬ ìŒì‹", "ë§›ì§‘ íˆ¬ì–´" â†’ RESTAURANT íƒ€ìž… ìž¥ì†Œ ìš°ì„  í¬í•¨

2. **íŠ¹ì • ìš”êµ¬ì‚¬í•­ ì¶”ì¶œ**:
   - "ì¹´íŽ˜ì—ì„œ ì—¬ìœ ë¡­ê²Œ" â†’ CAFE ìž¥ì†Œ í¬í•¨, ì¶©ë¶„í•œ ì²´ë¥˜ì‹œê°„ í• ë‹¹
   - "ë§›ìžˆëŠ” ë¼ë©˜ ê°€ê²Œ ê°€ê³  ì‹¶ë‹¤" â†’ Google Mapsë¡œ ë¼ë©˜ì§‘ ê²€ìƒ‰í•˜ì—¬ ì¶”ê°€
   - "ì‡¼í•‘ ë§Žì´ í•˜ê³  ì‹¶ì–´" â†’ ì‡¼í•‘ ìž¥ì†Œ ë¹„ì¤‘ ë†’ì´ê¸°

3. **ì´ë™ ìˆ˜ë‹¨ ì¶”ë¡ ** (travel_time ê³„ì‚°ì— ë°˜ì˜ ë° JSON ì‘ë‹µì— í¬í•¨):
   - "ë Œí„°ì¹´", "ì°¨ ë¹Œë ¤ì„œ", "ìžë™ì°¨" â†’ **DRIVE**
   - "ì§€í•˜ì² ", "ë²„ìŠ¤", "ëŒ€ì¤‘êµí†µ" â†’ **TRANSIT**
   - "ê±¸ì–´ì„œ", "ë„ë³´", "ì‚°ì±…" â†’ **WALK**
   - "ìžì „ê±°" â†’ **BICYCLE**
   - ì–¸ê¸‰ ì—†ìŒ â†’ **TRANSIT (ê¸°ë³¸ê°’)**
   - **ì¤‘ìš”**: ì¶”ë¡ í•œ ì´ë™ ìˆ˜ë‹¨ì„ JSON ì‘ë‹µì˜ "travel_mode" í•„ë“œì— ë°˜ë“œì‹œ í¬í•¨í•˜ì„¸ìš”

### 1-E. í›„ë³´ ìž¥ì†Œ(places) ìš°ì„  ì„ íƒ, í•˜ë£¨ ì¼ì • ê¸¸ì´ ë¯¸ì¶©ì¡± ì‹œ Geminiê°€ ìž¥ì†Œ ì ê·¹ ì¶”ì²œ

**í•„ìˆ˜ ì‚¬í•­**:
- places ìž¥ì†ŒëŠ” ì‚¬ìš©ìžê°€ ê´€ì‹¬ ìžˆì–´í•˜ëŠ” ìž¥ì†Œì´ë¯€ë¡œ ìµœëŒ€í•œ í¬í•¨í•˜ì„¸ìš”

**ìž¥ì†Œ ì„ íƒ í”„ë¡œì„¸ìŠ¤**:
1. **places ë¦¬ìŠ¤íŠ¸ ìš°ì„  ì„ íƒ**:
   - "ê³ ë ¤ ì¤‘ì¸ ìž¥ì†Œ ëª©ë¡ (places)"ì—ì„œ ì ì ˆí•œ ìž¥ì†Œë¥¼ ìš°ì„  ì„ íƒ
   - ì±„íŒ… ë‚´ìš©ì—ì„œ íŒŒì•…í•œ ì—¬í–‰ ìŠ¤íƒ€ì¼ì— ë§žëŠ” ìž¥ì†Œë¥¼ placesì—ì„œ ì„ íƒ
   - ì˜ˆ: "ì—¬ìœ ë¡œìš´ ì—¬í–‰" + placesì— CAFE/PARK â†’ ì´ ìž¥ì†Œë“¤ ìš°ì„  í¬í•¨

2. **ë¶€ì¡±í•œ ìž¥ì†ŒëŠ” Geminiê°€ ì ê·¹ ì¶”ì²œ**:
   - placesì— ì í•©í•œ ìž¥ì†Œê°€ ì—†ê±°ë‚˜ í•˜ë£¨ ì¼ì • ê¸¸ì´ì— ë¶€ì¡±í•˜ë©´ Google Mapsë¡œ ìƒˆ ìž¥ì†Œ ê²€ìƒ‰
   - ì˜ˆ: "ë§›ìžˆëŠ” ë¼ë©˜ ê°€ê²Œ" ìš”ì²­ + placesì— ë¼ë©˜ì§‘ ì—†ìŒ
     â†’ Google Mapsë¡œ í•´ë‹¹ ì§€ì—­ ìœ ëª… ë¼ë©˜ ê°€ê²Œ ì¶”ì²œ

3. **place_tag í™œìš©**:
   - placesì˜ ìž¥ì†Œë¥¼ ì¼ì •ì— ì‚¬ìš©í•  ë•ŒëŠ” í•´ë‹¹ place_tag ê·¸ëŒ€ë¡œ ì‚¬ìš©
   - Geminiê°€ ìƒˆë¡œ ì¶”ì²œí•˜ëŠ” ìž¥ì†ŒëŠ” ê°€ìž¥ ì ì ˆí•œ place_tag ì„ íƒ
   - ê°€ëŠ¥í•œ ê°’: TOURIST_SPOT, HOME, RESTAURANT, CAFE, OTHER

### 1-F. í•˜ë£¨ ì¼ì • ê¸¸ì´ í•„ìˆ˜ ì¤€ìˆ˜ (MANDATORY)

**ì ˆëŒ€ì  í•„ìˆ˜ ì‚¬í•­**:
- **ê¸°ë³¸ê°’**: í•˜ë£¨ ì¼ì •ì€ **ë°˜ë“œì‹œ 10-12ì‹œê°„** ì •ë„ê°€ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤
- **ê³„ì‚° ë°©ë²•**: ì²« visitì˜ arrival ~ ë§ˆì§€ë§‰ visitì˜ departure
- **ì˜ˆì™¸ ì²˜ë¦¬**: ì‚¬ìš©ìž ëŒ€í™”(chat)ë‚˜ ê·œì¹™(rule)ì— ë‹¤ë¥¸ ìš”ì²­ì´ ìžˆìœ¼ë©´ ê·¸ì— ë”°ë¥´ë˜, **ìµœì†Œ ì¼ì • ê¸¸ì´ëŠ” ë°˜ë“œì‹œ í™•ë³´**í•˜ì„¸ìš”
  - "ì—¬ìœ ë¡­ê²Œ", "ëŠê¸‹í•˜ê²Œ", "ì²œì²œížˆ" â†’ **8-10ì‹œê°„** (ìž¥ì†Œ ìˆ˜ëŠ” ì¤„ì´ë˜, ì²´ë¥˜ì‹œê°„ì„ ëŠ˜ë ¤ì„œ ì¼ì • ê¸¸ì´ í™•ë³´)
  - "ì•Œì°¨ê²Œ", "ë§Žì´ ë³´ê³  ì‹¶ì–´", "ë¹¡ë¹¡í•˜ê²Œ" â†’ **12-14ì‹œê°„**
  - ëª…ì‹œì  ìš”ì²­ ì—†ìŒ â†’ **10-12ì‹œê°„ (ê¸°ë³¸ê°’)**

**ì¤‘ìš”**: "ì—¬ìœ ë¡­ê²Œ"ëŠ” **ì¼ì •ì„ ì§§ê²Œ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼**, ìž¥ì†Œë¥¼ ì ê²Œ ë°©ë¬¸í•˜ê³  ê° ìž¥ì†Œì—ì„œ ì¶©ë¶„í•œ ì‹œê°„ì„ ë³´ë‚´ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ**:
- âŒ **ìž˜ëª»ëœ í•´ì„**: "ì—¬ìœ ë¡­ê²Œ" â†’ 09:00-14:00 (5ì‹œê°„) - ë„ˆë¬´ ì§§ìŒ!
- â­• **ì˜¬ë°”ë¥¸ í•´ì„**: "ì—¬ìœ ë¡­ê²Œ" â†’ 09:00-17:00 (8ì‹œê°„), ìž¥ì†Œ 3-4ê³³ë§Œ ë°©ë¬¸, ê° ìž¥ì†Œ ì²´ë¥˜ì‹œê°„ 2-3ì‹œê°„

**ê²€ì¦ ë°©ë²•**:
- ê° dayì—ì„œ: (ë§ˆì§€ë§‰ visitì˜ departure) - (ì²« visitì˜ arrival) = ì¼ì • ê¸¸ì´
- ê¸°ë³¸: 10-12ì‹œê°„, ì—¬ìœ : 8-10ì‹œê°„, ì•Œì°¨ê²Œ: 12-14ì‹œê°„
- ì´ ê¸°ì¤€ì„ **ë°˜ë“œì‹œ** ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤

**ì ˆëŒ€ ê·œì¹™**:
- ì–´ë–¤ ìƒí™©ì—ì„œë„ í•˜ë£¨ ì¼ì •ì´ 8ì‹œê°„ ë¯¸ë§Œì´ ë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤ (ë§ˆì§€ë§‰ ë‚  ê³µí•­ ì´ë™ ë“± íŠ¹ìˆ˜í•œ ê²½ìš° ì œì™¸)
- ì¼ì • ê¸¸ì´ê°€ ë¶€ì¡±í•˜ë©´ ì²´ë¥˜ì‹œê°„ì„ ëŠ˜ë¦¬ê±°ë‚˜ ìž¥ì†Œë¥¼ ì¶”ê°€í•˜ì—¬ ê¸¸ì´ë¥¼ ë§žì¶”ì„¸ìš”

---

## ðŸŸ  Priority 2: ìš´ì˜ì‹œê°„ ë° ì´ë™ì‹œê°„ ì¤€ìˆ˜ (HIGHLY RECOMMENDED - 90%+)

ì´ ìš°ì„ ìˆœìœ„ëŠ” **Priority 1ê³¼ ì¶©ëŒí•˜ì§€ ì•ŠëŠ” í•œ ìµœëŒ€í•œ ì¤€ìˆ˜**í•´ì•¼ í•©ë‹ˆë‹¤.

### 2-A. ìš´ì˜ì‹œê°„ ì¤€ìˆ˜

**í•„ìˆ˜ ì‚¬í•­**:
- ëª¨ë“  ë°©ë¬¸ì€ ìš´ì˜ì‹œê°„ ë‚´ì—ë§Œ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤
- arrival â‰¥ opening_time AND departure â‰¤ closing_time
- íœ´ë¬´ì¼(closed) ë°©ë¬¸ ì ˆëŒ€ ê¸ˆì§€
- Google Maps Grounding Toolë¡œ ì‹¤ì œ ìš´ì˜ì‹œê°„ í™•ì¸ í•„ìˆ˜

**ìš”ì¼ë³„ ìš´ì˜ì‹œê°„ í™•ì¸**:
ì—¬í–‰ ì¼ì •ì˜ ê° ë‚ ì§œì™€ ìš”ì¼ ì •ë³´ëŠ” ìƒë‹¨ì˜ "ì—¬í–‰ ê¸°ê°„" ì„¹ì…˜ì— ëª…ì‹œë˜ì–´ ìžˆìŠµë‹ˆë‹¤.
- ì˜ˆ: "Day 1: 2025-10-15 (ìˆ˜ìš”ì¼)" â†’ í•´ë‹¹ ë‚ ì§œëŠ” ìˆ˜ìš”ì¼
- **ì¤‘ìš”**: Google Mapsì—ì„œ ê° ìž¥ì†Œì˜ í•´ë‹¹ ìš”ì¼ ìš´ì˜ì‹œê°„ì„ í™•ì¸í•˜ì„¸ìš”
  - Day 1ì´ ìˆ˜ìš”ì¼ì´ë©´ Wednesday ìš´ì˜ì‹œê°„ ì‚¬ìš©
  - Day 2ê°€ ëª©ìš”ì¼ì´ë©´ Thursday ìš´ì˜ì‹œê°„ ì‚¬ìš©
- í•´ë‹¹ ìš”ì¼ì— íœ´ë¬´(closed)ì´ë©´ ê·¸ ë‚ ì§œì—ëŠ” ì ˆëŒ€ ë°©ë¬¸í•˜ì§€ ë§ˆì„¸ìš”

**ì˜ˆì‹œ**:
- ë°•ë¬¼ê´€ì´ ì›”ìš”ì¼ íœ´ë¬´ â†’ ì›”ìš”ì¼ì—ëŠ” ì¼ì •ì— í¬í•¨í•˜ì§€ ì•ŠìŒ
- í…Œë§ˆíŒŒí¬ ìš´ì˜ì‹œê°„ 09:00-21:00 â†’ arrivalì€ 09:00 ì´í›„, departureëŠ” 21:00 ì´ì „
- ë ˆìŠ¤í† ëž‘ ì˜ì—…ì‹œê°„ 11:30-22:00 â†’ ì ì‹¬ ë°©ë¬¸ ì‹œ arrivalì€ 11:30 ì´í›„

**Priority 1 ì¶©ëŒ ì‹œ**:
- must_visit ìš°ì„ , ë‚ ì§œ ìž¬ì¡°ì •ìœ¼ë¡œ ìš´ì˜ì‹œê°„ ë§žì¶¤

### 2-B. ì´ë™ì‹œê°„ ê³„ì‚° ê°€ì´ë“œ

**ì¤‘ìš”**: travel_timeì€ ì°¸ê³ ìš©ìœ¼ë¡œ ìƒì„±í•˜ë˜, ì¼ì • ìƒì„± í›„ Routes APIë¡œ ì‹¤ì œê°’ì´ ìžë™ ëŒ€ì²´ë©ë‹ˆë‹¤. Google Maps Grounding Toolì€ travel_time ì¶”ì •ì— í™œìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

**í•„ìˆ˜ ì‚¬í•­**:
- Google Maps Grounding Toolì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ ì´ë™ì‹œê°„ì„ ê³„ì‚°í•˜ì„¸ìš”
- êµí†µìˆ˜ë‹¨ì„ ê³ ë ¤í•˜ì„¸ìš” (DRIVE/TRANSIT/WALK/BICYCLE)
- visit[i+1].arrival = visit[i].departure + visit[i].travel_time

**êµí†µìˆ˜ë‹¨ ì„ íƒ** (1-Dì—ì„œ ì¶”ë¡ ):
- **DRIVE**: ìžë™ì°¨ ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„
- **TRANSIT**: ëŒ€ì¤‘êµí†µ ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„ (í™˜ìŠ¹ í¬í•¨) - **ê¸°ë³¸ê°’**
- **WALK**: ë„ë³´ ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„
- **BICYCLE**: ìžì „ê±° ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„

**travel_time ê³„ì‚° ê·œì¹™** (ë§¤ìš° ì¤‘ìš”):
- **ì²« ë²ˆì§¸ ë°©ë¬¸ì˜ travel_time**: ì²« ë²ˆì§¸ ìž¥ì†Œ â†’ ë‘ ë²ˆì§¸ ìž¥ì†Œ ì´ë™ì‹œê°„
- **ì¤‘ê°„ ë°©ë¬¸ì˜ travel_time**: í˜„ìž¬ ìž¥ì†Œ â†’ ë‹¤ìŒ ìž¥ì†Œ ì´ë™ì‹œê°„
- **ë§ˆì§€ë§‰ ë°©ë¬¸ì˜ travel_time**: 0 (ë‹¤ìŒ ìž¥ì†Œê°€ ì—†ìŒ)

**ê³„ì‚° ê³µì‹**:
```
next_place.arrival = current_place.departure + travel_time
```

**ì˜ˆì‹œ**:
- Visit 1 (ì˜¤ì‚¬ì¹´ ì„±): departure "11:30", travel_time 30ë¶„
- Visit 2 (ë„í†¤ë³´ë¦¬): arrival "12:00" (11:30 + 30ë¶„)
- Visit 2 (ë„í†¤ë³´ë¦¬): departure "14:00", travel_time 0 (ë§ˆì§€ë§‰ ë°©ë¬¸)

**ê²€ì¦**:
- ê° ì—°ì†ëœ ë°©ë¬¸ ì‚¬ì´: visit[i+1].arrival = visit[i].departure + visit[i].travel_time
- ì‹¤ì‹œê°„ êµí†µ ìƒí™©, ëŒ€ì¤‘êµí†µ ë°°ì°¨ ê°„ê²©ì„ ê³ ë ¤í•œ í˜„ì‹¤ì ì¸ ì´ë™ì‹œê°„ ë°˜ì˜

---

## ðŸŸ¡ Priority 3: ë§¥ë½ì  ìˆœì„œ ë°°ì¹˜ (RECOMMENDED - 80%+)

ì´ ìš°ì„ ìˆœìœ„ëŠ” **Priority 1, 2ë¥¼ ë§Œì¡±í•œ í›„ ì¶”ê°€ ê°œì„  ì‚¬í•­**ìž…ë‹ˆë‹¤.

### 3-A. ì²´ë¥˜ì‹œê°„ ì ì ˆì„±

**âš ï¸ ì¤‘ìš”: ì²« ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ ë°©ë¬¸ì§€ëŠ” ì²´ë¥˜ì‹œê°„ 0ìœ¼ë¡œ ì„¤ì •**

í•˜ë£¨ ì¼ì •ì˜ ì²« ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ visitì€ ì¶œë°œ/ë„ì°©ì„ ì˜ë¯¸í•˜ë¯€ë¡œ ì²´ë¥˜ì‹œê°„ì´ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤:
- **ì²« ë²ˆì§¸ visit**: `departure = arrival` (ì¶œë°œ ì‹œê°„ë§Œ ì˜ë¯¸)
- **ë§ˆì§€ë§‰ visit**: `departure = arrival` (ë„ì°© ì‹œê°„ë§Œ ì˜ë¯¸)
- **ì˜ˆì‹œ**:
  ```json
  "visits": [
    {{
      "order": 1,
      "display_name": "í˜¸í…”",
      "arrival": "09:00",
      "departure": "09:00",  // ì²´ë¥˜ì‹œê°„ 0
      "travel_time": 20
    }},
    {{
      "order": 2,
      "display_name": "ì˜¤ì‚¬ì¹´ ì„±",
      "arrival": "09:20",
      "departure": "11:50",  // ì²´ë¥˜ 2.5ì‹œê°„
      "travel_time": 30
    }},
    {{
      "order": 3,
      "display_name": "í˜¸í…”",
      "arrival": "12:20",
      "departure": "12:20",  // ì²´ë¥˜ì‹œê°„ 0
      "travel_time": 0
    }}
  ]
  ```

**ì¤‘ê°„ ë°©ë¬¸ì§€ì˜ ì ì ˆí•œ ì²´ë¥˜ì‹œê°„**:
- **ëŒ€í˜• í…Œë§ˆíŒŒí¬** (ìœ ë‹ˆë²„ì„¤ ìŠ¤íŠœë””ì˜¤ ë“±): 6-10ì‹œê°„
- **ì£¼ìš” ê´€ê´‘ì§€** (ì„±, ì‚¬ì› ë“±): 1.5-3ì‹œê°„
- **ìˆ˜ì¡±ê´€/ë°•ë¬¼ê´€**: 2-3ì‹œê°„
- **ì‡¼í•‘ ê±°ë¦¬**: 1-2ì‹œê°„
- **ì‹ì‚¬**: 1-1.5ì‹œê°„
- **ì¹´íŽ˜/íœ´ì‹**: 0.5-1ì‹œê°„

**ì ìš© ë°©ë²•**:
- ì¤‘ê°„ ë°©ë¬¸ì§€: departure = arrival + ì ì ˆí•œ ì²´ë¥˜ì‹œê°„
- ìž¥ì†Œì˜ íŠ¹ì„±ê³¼ ì‚¬ìš©ìž ì·¨í–¥(chat)ì„ ê³ ë ¤í•˜ì—¬ ì¡°ì •
- ì˜ˆ: "ì—¬ìœ ë¡­ê²Œ" ì„ í˜¸ â†’ ì²´ë¥˜ì‹œê°„ ê¸¸ê²Œ ì„¤ì •

### 3-B. ë°©ë¬¸ ì‹œê°„ëŒ€ ì ì ˆì„±

**ì‹ì‚¬ì‹œê°„ ê³ ë ¤**:
- **ì ì‹¬**: 11:30-13:30 ì‚¬ì´ì— RESTAURANT ë°©ë¬¸
- **ì €ë…**: 18:00-20:00 ì‚¬ì´ì— RESTAURANT ë°©ë¬¸
- ì‹ì‚¬ ì‹œê°„ì„ ê³ ë ¤í•˜ì—¬ ê´€ê´‘ì§€ ë°©ë¬¸ ìˆœì„œ ì¡°ì •

**ì‹œê°„ëŒ€ë³„ ì ì ˆí•œ í™œë™**:
- **ì•„ì¹¨ (09:00-12:00)**: ê´€ê´‘ì§€ ë°©ë¬¸, ë°•ë¬¼ê´€
- **ì ì‹¬ (12:00-14:00)**: ì‹ì‚¬, ë§›ì§‘ íƒë°©
- **ì˜¤í›„ (14:00-18:00)**: ê´€ê´‘ì§€ ë°©ë¬¸, ì‡¼í•‘
- **ì €ë… (18:00-20:00)**: ì‹ì‚¬, ì•¼ê²½ ê°ìƒ
- **ë°¤ (20:00-22:00)**: ì¹´íŽ˜, ì•¼ì‹œìž¥, ìˆ™ì†Œ ë³µê·€

### 3-C. ìžì—°ìŠ¤ëŸ¬ìš´ í™œë™ íë¦„

**ê¶Œìž¥ íŒ¨í„´**:
- ê´€ê´‘ â†’ ì‹ì‚¬ â†’ ì¹´íŽ˜ â†’ ê´€ê´‘
- ì‹¤ë‚´ â†’ ì‹¤ì™¸ â†’ ì‹¤ë‚´ (ë‚ ì”¨/ì²´ë ¥ ê³ ë ¤)
- í™œë™ì  â†’ íœ´ì‹ â†’ í™œë™ì  (ì²´ë ¥ ë¶„ì‚°)

**ì˜ˆì‹œ**:
- ì˜¤ì „: ì˜¤ì‚¬ì¹´ ì„± (ê´€ê´‘, 2.5ì‹œê°„)
- ì ì‹¬: í˜„ì§€ ë§›ì§‘ (ì‹ì‚¬, 1ì‹œê°„)
- ì˜¤í›„: ë„í†¤ë³´ë¦¬ ì‚°ì±… (ê´€ê´‘, 2ì‹œê°„)
- ì €ë…: ì¹´íŽ˜ íœ´ì‹ (ì¹´íŽ˜, 1ì‹œê°„)
- ì €ë…: ì €ë… ì‹ì‚¬ (ì‹ì‚¬, 1.5ì‹œê°„)

---

## ðŸŸ¢ Priority 4: íš¨ìœ¨ì ì¸ ë™ì„  (OPTIMIZATION - Best Effort)

ì´ ìš°ì„ ìˆœìœ„ëŠ” **Priority 1-3ì„ ë§Œì¡±í•œ í›„ ìµœì í™” ì‚¬í•­**ìž…ë‹ˆë‹¤.

### 4-A. ì´ë™ì‹œê°„ ìµœì†Œí™”

**ê¶Œìž¥ ì‚¬í•­**:
- ì§€ë¦¬ì ìœ¼ë¡œ ê°€ê¹Œìš´ ìž¥ì†Œë“¤ì„ ë¬¶ì–´ì„œ ë°°ì¹˜í•˜ì„¸ìš”
- ê°™ì€ ì§€ì—­/êµ¬ì—­ ë‚´ ìž¥ì†Œë“¤ì„ ì—°ì†ìœ¼ë¡œ ë°©ë¬¸í•˜ì„¸ìš”
- ë¶ˆí•„ìš”í•œ ì™•ë³µ ì´ë™ì„ í”¼í•˜ì„¸ìš”

**ì˜ˆì‹œ**:
- â­• ì¢‹ì€ ë™ì„ : ì˜¤ì‚¬ì¹´ ì„± â†’ ë„í†¤ë³´ë¦¬ â†’ ë‚œë°” (ë‚¨ìª½ ë°©í–¥ìœ¼ë¡œ ì´ë™)
- âŒ ë‚˜ìœ ë™ì„ : ì˜¤ì‚¬ì¹´ ì„± â†’ ìš°ë©”ë‹¤ â†’ ë„í†¤ë³´ë¦¬ â†’ ë‚œë°” (ë¶ìª½ ê°”ë‹¤ê°€ ë‹¤ì‹œ ë‚¨ìª½)

### 4-B. ì§€ì—­ë³„ í´ëŸ¬ìŠ¤í„°ë§

**ê¶Œìž¥ ì‚¬í•­**:
- ë™ì¼ ì§€ì—­ ë‚´ ìž¥ì†Œë“¤ì„ í•˜ë£¨ì— ë¬¶ì–´ì„œ ë°©ë¬¸í•˜ì„¸ìš”
- ì˜ˆ: Day 1ì€ ì˜¤ì‚¬ì¹´ ë‚¨ë¶€, Day 2ëŠ” ì˜¤ì‚¬ì¹´ ë¶ë¶€
- ì§€ì—­ ê°„ ëŒ€ì´ë™ì€ í•˜ë£¨ì— 1íšŒ ì´í•˜ë¡œ ì œí•œí•˜ì„¸ìš”

---

## ðŸ”µ Priority 5: í‰ì  ìš°ì„  ì„ íƒ (NICE TO HAVE - Best Effort)

ì´ ìš°ì„ ìˆœìœ„ëŠ” **Priority 1-4ë¥¼ ë§Œì¡±í•œ í›„ ì¶”ê°€ ê°œì„  ì‚¬í•­**ìž…ë‹ˆë‹¤.

### 5-A. í‰ì  ë†’ì€ ìž¥ì†Œ ìš°ì„  ì„ íƒ

**ê¶Œìž¥ ì‚¬í•­**:
- ë™ì¼ ì¡°ê±´(ìœ„ì¹˜, ì‹œê°„, ìœ í˜•)ì˜ ìž¥ì†Œê°€ ì—¬ëŸ¬ ê°œ ìžˆì„ ê²½ìš°, í‰ì ì´ ë†’ì€ ê³³ì„ ì„ íƒí•˜ì„¸ìš”
- Google Mapsì˜ í‰ì (rating)ê³¼ ë¦¬ë·° ìˆ˜(user_ratings_total)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”
- ë‹¨, Priority 1-4ë¥¼ ìœ„ë°˜í•˜ë©´ì„œê¹Œì§€ í‰ì ì„ ìš°ì„ í•˜ì§€ ë§ˆì„¸ìš”

**ì˜ˆì‹œ**:
- ë‘ ê°œì˜ ë¼ë©˜ì§‘ì´ ë™ì¼ ì§€ì—­ì— ìžˆê³ , ìš´ì˜ì‹œê°„ë„ ë™ì¼í•œ ê²½ìš°
  â†’ í‰ì  4.5 (ë¦¬ë·° 1000ê°œ) vs í‰ì  4.0 (ë¦¬ë·° 500ê°œ)
  â†’ í‰ì  4.5 ì„ íƒ

---

## ì œì•½ì‚¬í•­

### í•˜ë£¨ ì¼ì • ê¸¸ì´
- **ê¸°ë³¸ê°’**: í•˜ë£¨ ì¼ì •ì€ 10-12ì‹œê°„ ì •ë„ê°€ ì ì ˆí•©ë‹ˆë‹¤
- **ê³„ì‚° ë°©ë²•**: ì²« visitì˜ arrival ~ ë§ˆì§€ë§‰ visitì˜ departure
- **ì˜ˆì™¸**: ì‚¬ìš©ìž ëŒ€í™”(chat)ë‚˜ ê·œì¹™(rule)ì— ë‹¤ë¥¸ ìš”ì²­ì´ ìžˆìœ¼ë©´ ê·¸ì— ë”°ë¥´ì„¸ìš”
  - ì˜ˆ: "ì—¬ìœ ë¡­ê²Œ" â†’ 8-10ì‹œê°„
  - ì˜ˆ: "ì•Œì°¨ê²Œ ë§Žì´ ë³´ê³  ì‹¶ì–´" â†’ 12-14ì‹œê°„

### ìˆ™ì†Œ(HOME) ì¶œë°œ/ê·€ê°€ ì›ì¹™
- **ê¸°ë³¸ ì›ì¹™**: í•˜ë£¨ ì¼ì •ì˜ ì‹œìž‘ê³¼ ëì€ ìˆ™ì†Œì—¬ì•¼ í•©ë‹ˆë‹¤. ê·¸ ì™¸ì— ìˆ™ì†Œ ë°©ë¬¸ì€ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  - ì²« visit: ìˆ™ì†Œ ì¶œë°œ (place_tag=HOME)
  - ë§ˆì§€ë§‰ visit: ìˆ™ì†Œ ê·€ê°€ (place_tag=HOME)
  - ëª…ì‹œì  ìš”ì²­ì´ ì—†ëŠ” í•œ ì´ ì›ì¹™ì„ ë°˜ë“œì‹œ ì¤€ìˆ˜í•˜ì„¸ìš”

### ìž¥ì†Œ ë°©ë¬¸ íšŸìˆ˜ ì œí•œ
- **ê¸°ë³¸ ì›ì¹™**: ëª¨ë“  ìž¥ì†ŒëŠ” ì „ì²´ ì¼ì • ë™ì•ˆ í•œ ë²ˆë§Œ ë°©ë¬¸í•´ì•¼ í•©ë‹ˆë‹¤ (ë‹¨, ìˆ™ì†ŒëŠ” ì œì™¸)
- **ìˆ™ì†Œ(HOME) ì˜ˆì™¸**:
  - ìˆ™ì†ŒëŠ” ë§¤ì¼ ì¶œë°œ/ê·€ê°€ ì§€ì ìœ¼ë¡œ ì‚¬ìš©ë˜ë¯€ë¡œ ì—¬ëŸ¬ ë²ˆ ë°©ë¬¸ ê°€ëŠ¥

- **ì˜ˆì™¸ ì¼€ì´ìŠ¤ ìš°ì„ ìˆœìœ„** (ë†’ì€ ìˆœì„œëŒ€ë¡œ):
  1. **rule í•„ë“œì˜ ëª…ì‹œì  ì§€ì‹œ** (ìµœìš°ì„ )
  2. **chatì˜ ëª…ì‹œì  ìš”ì²­**
  3. **ê¸°ë³¸ ì›ì¹™ (ìˆ™ì†Œ ì™•ë³µ)** (ê¸°ë³¸ê°’)

- **ì˜ˆì™¸ ì¼€ì´ìŠ¤ 1: rule í•„ë“œ ê¸°ë°˜** (ìµœìš°ì„  ì ìš©):
  - ruleì— íŠ¹ì • ì¶œë°œ/ë„ì°© ì§€ì ì´ ëª…ì‹œëœ ê²½ìš° ìš°ì„  ì ìš©
  - **ì¸ì‹ íŒ¨í„´**:
    - "Day X: [ìž¥ì†Œ]ì—ì„œ ì¶œë°œ" â†’ í•´ë‹¹ ë‚ ì§œëŠ” [ìž¥ì†Œ]ì—ì„œ ì‹œìž‘
    - "Day X: [ìž¥ì†Œ]ë¡œ ì´ë™" â†’ í•´ë‹¹ ë‚ ì§œëŠ” [ìž¥ì†Œ]ë¡œ ì¢…ë£Œ
    - "ì²«ë‚  [ìž¥ì†Œ]ì—ì„œ ì‹œìž‘" â†’ Day 1ì€ [ìž¥ì†Œ]ì—ì„œ ì‹œìž‘
    - "ë§ˆì§€ë§‰ë‚  [ìž¥ì†Œ]ë¡œ ì§í–‰" â†’ ë§ˆì§€ë§‰ dayëŠ” [ìž¥ì†Œ]ë¡œ ì¢…ë£Œ
  - **ì˜ˆì‹œ**:
    - rule: ["ì²«ë‚ ì€ ê°„ì‚¬ì´ ê³µí•­ì—ì„œ ì¶œë°œ", "ë§ˆì§€ë§‰ë‚ ì€ ê³µí•­ìœ¼ë¡œ ì§í–‰"]
      â†’ Day 1: ê³µí•­ ì¶œë°œ (ìˆ™ì†Œ ì¶œë°œ X), ë§ˆì§€ë§‰ Day: ê³µí•­ ë„ì°© (ìˆ™ì†Œ ê·€ê°€ X)
    - rule: ["ë‘˜ì§¸ë‚ ì€ êµí† ì—­ì—ì„œ ì‹œìž‘"]
      â†’ Day 2: êµí† ì—­ ì¶œë°œ (ìˆ™ì†Œ ì¶œë°œ X), ë‹¤ë¥¸ ë‚ ì§œëŠ” ìˆ™ì†Œ ì™•ë³µ
  - **ì ìš© ë²”ìœ„**: íŠ¹ì • ë‚ ì§œë§Œ ì˜ˆì™¸ ì ìš©, ëª…ì‹œë˜ì§€ ì•Šì€ ë‚ ì§œëŠ” ê¸°ë³¸ ì›ì¹™ ì ìš©

- **ì˜ˆì™¸ ì¼€ì´ìŠ¤ 2: chat í•„ë“œ ê¸°ë°˜**:
  - chatì— ëª…ì‹œì ì¸ ì¶œë°œ/ë„ì°© ìš”ì²­ì´ ìžˆëŠ” ê²½ìš° ì ìš©
  - **ì¸ì‹ íŒ¨í„´**:
    - "ê³µí•­ì—ì„œ ì¶œë°œ", "ê³µí•­ì—ì„œ ë°”ë¡œ ì‹œìž‘" â†’ Day 1ì€ ê³µí•­ ì¶œë°œ
    - "ì—­ì—ì„œ ì‹œìž‘", "XXì—­ì—ì„œ ì¶œë°œ" â†’ Day 1ì€ í•´ë‹¹ ì—­ ì¶œë°œ
    - "ë§ˆì§€ë§‰ë‚  ê³µí•­ ê°€ì•¼ í•´", "ê³µí•­ìœ¼ë¡œ ë°”ë¡œ ê°€ê³  ì‹¶ì–´" â†’ ë§ˆì§€ë§‰ dayëŠ” ê³µí•­ ë„ì°©
    - "ì²«ë‚ ì€ í˜¸í…” ì²´í¬ì¸ ì•ˆ í•˜ê³  ë°”ë¡œ ê´€ê´‘" â†’ Day 1ì€ ìˆ™ì†Œ ì¶œë°œ ì—†ì´ ê´€ê´‘ì§€ ì§í–‰
  - **ì˜ˆì‹œ**:
    - chat: ["ì²«ë‚  ê³µí•­ ë„ì°©í•´ì„œ ë°”ë¡œ ê´€ê´‘ ì‹œìž‘í•˜ê³  ì‹¶ì–´ìš”"]
      â†’ Day 1: ê³µí•­ì—ì„œ ì¶œë°œ, ë§ˆì§€ë§‰ visitì€ ìˆ™ì†Œ ê·€ê°€
    - chat: ["ë§ˆì§€ë§‰ë‚  ì˜¤ì „ ë¹„í–‰ê¸°ë¼ ê³µí•­ ê°€ì•¼ í•´ìš”"]
      â†’ ë§ˆì§€ë§‰ Day: ìˆ™ì†Œ ì¶œë°œ, ë§ˆì§€ë§‰ visitì€ ê³µí•­ ë„ì°©
  - **ì ìš© ë²”ìœ„**: ëª…ì‹œëœ ë‚ ì§œ/ìƒí™©ë§Œ ì˜ˆì™¸ ì ìš©

- **ì˜ˆì™¸ ì ìš© ê°€ì´ë“œë¼ì¸**:
  - **ë¶€ë¶„ ì˜ˆì™¸ í—ˆìš©**: í•œ dayì˜ ì‹œìž‘ë§Œ ì˜ˆì™¸, ë˜ëŠ” ëë§Œ ì˜ˆì™¸ ê°€ëŠ¥
    - ì˜ˆ: Day 1ì€ ê³µí•­ ì¶œë°œ â†’ ìˆ™ì†Œ ê·€ê°€ (ì¶œë°œë§Œ ì˜ˆì™¸)
    - ì˜ˆ: ë§ˆì§€ë§‰ dayëŠ” ìˆ™ì†Œ ì¶œë°œ â†’ ê³µí•­ ë„ì°© (ë„ì°©ë§Œ ì˜ˆì™¸)
  - **ëª…ì‹œë˜ì§€ ì•Šì€ ë‚ ì§œëŠ” ê¸°ë³¸ ì›ì¹™ ì ìš©**:
    - rule/chatì—ì„œ Day 1ë§Œ ì–¸ê¸‰ â†’ Day 2, 3, ...ì€ ìˆ™ì†Œ ì™•ë³µ
  - **ëª¨í˜¸í•œ ê²½ìš° ê¸°ë³¸ ì›ì¹™ ìš°ì„ **:
    - "ê³µí•­ ê·¼ì²˜ ìˆ™ì†Œ" (ìœ„ì¹˜ ì„ í˜¸ë„) â‰  "ê³µí•­ì—ì„œ ì¶œë°œ" (ì¶œë°œ ì§€ì  ëª…ì‹œ)
    - ëª…ì‹œì  ìš”ì²­ì´ ì•„ë‹ˆë©´ ìˆ™ì†Œ ì™•ë³µ ìœ ì§€

- **ì˜ˆì™¸ ì ìš© ì˜ˆì‹œ**:
  - **ì˜ˆì‹œ 1** (rule ê¸°ë°˜):
    - rule: ["ì²«ë‚  ê°„ì‚¬ì´ ê³µí•­ ë„ì°© í›„ ë°”ë¡œ ê´€ê´‘", "ë§ˆì§€ë§‰ë‚  ì˜¤ì „ ë¹„í–‰ê¸°ë¡œ ê·€êµ­"]
    - ì ìš©:
      - Day 1: ê°„ì‚¬ì´ ê³µí•­(OTHER) â†’ ê´€ê´‘ì§€ë“¤ â†’ ìˆ™ì†Œ(HOME)
      - Day 2: ìˆ™ì†Œ(HOME) â†’ ê´€ê´‘ì§€ë“¤ â†’ ìˆ™ì†Œ(HOME)
      - Day 3: ìˆ™ì†Œ(HOME) â†’ ê´€ê´‘ì§€ë“¤ â†’ ê°„ì‚¬ì´ ê³µí•­(OTHER)

  - **ì˜ˆì‹œ 2** (chat ê¸°ë°˜):
    - chat: ["ì²«ë‚  ê³µí•­ì—ì„œ ë°”ë¡œ ë„í†¤ë³´ë¦¬ ê°€ê³  ì‹¶ì–´ìš”"]
    - ì ìš©:
      - Day 1: ê°„ì‚¬ì´ ê³µí•­(OTHER) â†’ ë„í†¤ë³´ë¦¬(TOURIST_SPOT) â†’ ... â†’ ìˆ™ì†Œ(HOME)
      - Day 2-3: ìˆ™ì†Œ(HOME) â†’ ê´€ê´‘ì§€ë“¤ â†’ ìˆ™ì†Œ(HOME)

  - **ì˜ˆì‹œ 3** (ê¸°ë³¸ ì›ì¹™):
    - rule: ì—†ìŒ, chat: ["ì˜¤ì‚¬ì¹´ 3ì¼ ì—¬í–‰, ë‚œë°”ì—ì„œ ìˆ™ì†Œ êµ¬í• ê²Œìš”"]
    - ì ìš©:
      - Day 1-3: ìˆ™ì†Œ(HOME) â†’ ê´€ê´‘ì§€ë“¤ â†’ ìˆ™ì†Œ(HOME)
      - ("ë‚œë°”ì—ì„œ ìˆ™ì†Œ"ëŠ” ìœ„ì¹˜ ì„ í˜¸ë„ì´ì§€ ì¶œë°œ ì§€ì ì´ ì•„ë‹˜)

### HOME ì—†ì„ ì‹œ Geminiê°€ ìˆ™ì†Œ ì¶”ì²œ
- **ìƒí™©**: accommodationì´ "ì—†ìŒ (ì¶”ì²œ í•„ìš”)"ë¡œ í‘œì‹œëœ ê²½ìš°
- **í•„ìˆ˜ ì‚¬í•­**: Geminiê°€ ì ì ˆí•œ ìˆ™ì†Œë¥¼ ì¶”ì²œí•˜ê³  ì¼ì •ì— í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤
- **ì¶”ì²œ ê¸°ì¤€**:
  - ì‚¬ìš©ìž ëŒ€í™”(chat)ì—ì„œ ìˆ™ì†Œ ê´€ë ¨ ì„ í˜¸ì‚¬í•­ ì¶”ë¡ 
  - ì ‘ê·¼ì„± ë†’ì€ ìœ„ì¹˜ (ëŒ€ì¤‘êµí†µ í—ˆë¸Œ, ê´€ê´‘ì§€ ì¤‘ì‹¬ë¶€)
  - í•©ë¦¬ì ì¸ ê°€ê²©ëŒ€ (chatì—ì„œ ì˜ˆì‚° íŒŒì•…)
  - Google Mapsë¡œ ì‹¤ì œ ìˆ™ì†Œ ê²€ìƒ‰ ë° ì •ë³´ í™•ì¸
- **ì¼ì • í¬í•¨**: ì¶”ì²œí•œ ìˆ™ì†Œë¥¼ place_tag=HOMEìœ¼ë¡œ ì¼ì • ì²«/ë§ˆì§€ë§‰ visitì— í¬í•¨

---

## ìˆ™ì†Œ(HOME) ì²˜ë¦¬ ë¡œì§

### HOME íƒœê·¸ ìž¥ì†Œ ì‹ë³„ ë° í™œìš©

**ìš°ì„ ìˆœìœ„ 1**: places í•„ë“œì— place_tag=HOMEì¸ ìž¥ì†Œê°€ ìžˆëŠ” ê²½ìš°
- ì´ê²ƒì´ ì‚¬ìš©ìžê°€ ì§€ì •í•œ ìˆ™ì†Œìž…ë‹ˆë‹¤
- accommodation í•„ë“œì— í•´ë‹¹ ìˆ™ì†Œëª…ì´ í‘œì‹œë˜ì–´ ìžˆìŠµë‹ˆë‹¤
- í•´ë‹¹ ìˆ™ì†Œë¥¼ ì‚¬ìš©í•˜ê³ , Google Mapsë¡œ ì •í™•í•œ ì¢Œí‘œì™€ ì£¼ì†Œë¥¼ ì¡°íšŒí•˜ì„¸ìš”

**ìš°ì„ ìˆœìœ„ 2**: accommodationì´ "ì—†ìŒ (ì¶”ì²œ í•„ìš”)"ì¸ ê²½ìš°
- Geminiê°€ ì ì ˆí•œ ìˆ™ì†Œë¥¼ ì¶”ì²œí•´ì•¼ í•©ë‹ˆë‹¤ (ì•„ëž˜ ìƒì„¸ ê¸°ì¤€ ì°¸ê³ )

### í•˜ë£¨ ì¼ì • ì‹œìž‘/ì¢…ë£Œë¥¼ ìˆ™ì†Œë¡œ ì„¤ì •

**ê¸°ë³¸ íŒ¨í„´**:
```
ìˆ™ì†Œ (ì¶œë°œ) â†’ ê´€ê´‘ì§€1 â†’ ê´€ê´‘ì§€2 â†’ ... â†’ ìˆ™ì†Œ (ê·€ê°€)
```

**êµ¬í˜„ ë°©ë²•**:
- ê° dayì˜ ì²« ë²ˆì§¸ visit: ìˆ™ì†Œ ì¶œë°œ (place_tag=HOME)
- ê° dayì˜ ë§ˆì§€ë§‰ visit: ìˆ™ì†Œ ê·€ê°€ (place_tag=HOME)
- ìˆ™ì†Œ ì¶œë°œ ì‹œê°„: ì²« ê´€ê´‘ì§€ ë°©ë¬¸ì— ì ì ˆí•œ ì‹œê°„ìœ¼ë¡œ ì„¤ì •
  - ì˜ˆ: ì²« ê´€ê´‘ì§€ê°€ 10:00 ê°œìž¥ì´ë©´ 09:30 ì¶œë°œ
- ìˆ™ì†Œ ê·€ê°€ ì‹œê°„: ë§ˆì§€ë§‰ ê´€ê´‘ì§€ ë°©ë¬¸ í›„ ì´ë™ì‹œê°„ ê³ ë ¤

**ì˜ˆì™¸ ì²˜ë¦¬**:
- ê·œì¹™(rule)ì´ë‚˜ ëŒ€í™”(chat)ì— ë‹¤ë¥¸ íŒ¨í„´ì´ ëª…ì‹œëœ ê²½ìš° ìš°ì„  ì ìš©
- ì˜ˆ: "ë§ˆì§€ë§‰ë‚  ê³µí•­ìœ¼ë¡œ ì´ë™" â†’ ë§ˆì§€ë§‰ë‚ ì€ ìˆ™ì†Œ ê·€ê°€ ëŒ€ì‹  ê³µí•­ìœ¼ë¡œ ì¢…ë£Œ
- ì˜ˆ: "ì²«ë‚  ê³µí•­ì—ì„œ ì¶œë°œ" â†’ ì²«ë‚ ì€ ìˆ™ì†Œ ì¶œë°œ ëŒ€ì‹  ê³µí•­ì—ì„œ ì‹œìž‘

### HOME ì—†ì„ ê²½ìš° ìˆ™ì†Œ ì¶”ì²œ ìƒì„¸ ê¸°ì¤€

**ì¤‘ìš”**: HOMEì´ ì—†ìœ¼ë©´ Geminiê°€ ë°˜ë“œì‹œ ì ì ˆí•œ ìˆ™ì†Œë¥¼ ì¶”ì²œí•˜ê³  ì¼ì •ì— í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤!

**1. ì‚¬ìš©ìž ìš”êµ¬ì‚¬í•­ ë¶„ì„** (chatì—ì„œ ì¶”ë¡ ):
- **ìœ„ì¹˜ ì„ í˜¸ë„**:
  - ëª…ì‹œì  ì–¸ê¸‰: "ë‚œë°” ìª½", "ì—­ ê·¼ì²˜", "ì¤‘ì‹¬ê°€", "ì¡°ìš©í•œ ê³³", "ê³µí•­ ê·¼ì²˜"
  - ì•”ë¬µì  ì¶”ë¡ : ì£¼ìš” ê´€ê´‘ì§€ ì–¸ê¸‰ â†’ í•´ë‹¹ ì§€ì—­ ì¤‘ì‹¬ë¶€ ì¶”ì²œ
  - ì˜ˆ: "ë„í†¤ë³´ë¦¬ ë§Žì´ ê°€ê³  ì‹¶ì–´" â†’ ë„í†¤ë³´ë¦¬/ë‚œë°” ì§€ì—­ ìˆ™ì†Œ
- **ìˆ™ì†Œ ìœ í˜•**:
  - "í˜¸í…”", "ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤", "í˜¸ìŠ¤í…”", "ì—ì–´ë¹„ì•¤ë¹„", "ë¦¬ì¡°íŠ¸", "ë¹„ì¦ˆë‹ˆìŠ¤ í˜¸í…”"
  - ì–¸ê¸‰ ì—†ìœ¼ë©´: ì—¬í–‰ ì¸ì›(members)ê³¼ ìŠ¤íƒ€ì¼ ê³ ë ¤
    - 1-2ëª…: ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤/ë¹„ì¦ˆë‹ˆìŠ¤ í˜¸í…”
    - 3-4ëª…: ì¤‘ê¸‰ í˜¸í…”
    - 5ëª… ì´ìƒ: ëŒ€í˜• í˜¸í…”/ì—ì–´ë¹„ì•¤ë¹„
- **ê°€ê²©ëŒ€** (ëª…ì‹œì ìœ¼ë¡œ ì¶”ë¡ ):
  - "ì €ë ´í•œ", "ì‹¼", "ë°±íŒ¨ì»¤" â†’ ì €ê°€ (â‚©30,000-50,000/ë°•)
  - "ê°€ì„±ë¹„", "ì ë‹¹í•œ", "ê´œì°®ì€" â†’ ì¤‘ê°€ (â‚©50,000-100,000/ë°•)
  - "ì¢‹ì€", "ê¹¨ë—í•œ", "íŽ¸í•œ" â†’ ì¤‘ìƒê°€ (â‚©100,000-200,000/ë°•)
  - "ëŸ­ì…”ë¦¬", "ê³ ê¸‰", "ìµœê³ ê¸‰" â†’ ê³ ê°€ (â‚©200,000+/ë°•)
  - ì–¸ê¸‰ ì—†ìœ¼ë©´: ì¤‘ê°€(ê°€ì„±ë¹„) ê¸°ë³¸ê°’
- **íŽ¸ì˜ ì‹œì„¤**:
  - "ì¡°ì‹ í¬í•¨", "ì—­ì—ì„œ ê°€ê¹Œìš´", "íŽ¸ì˜ì  ê·¼ì²˜", "ì™€ì´íŒŒì´", "ì„¸íƒê¸°"

**2. ì ‘ê·¼ì„± ìš°ì„  ê³ ë ¤** (ìµœìš°ì„  ê¸°ì¤€):
- **ê´€ê´‘ì§€ ì¤‘ì‹¬ë¶€ ë˜ëŠ” ëŒ€ì¤‘êµí†µ í—ˆë¸Œ ê·¼ì²˜** ìˆ™ì†Œ ì„ íƒ í•„ìˆ˜
- **í‰ê·  ì´ë™ì‹œê°„ ê¸°ì¤€**:
  - ì£¼ìš” ê´€ê´‘ì§€ê¹Œì§€ ëŒ€ì¤‘êµí†µ 30ë¶„ ì´ë‚´
  - ê´€ê´‘ì§€ ì¤‘ì‹¬ë¶€ê¹Œì§€ 20ë¶„ ì´ë‚´ ê¶Œìž¥
  - must_visit ìž¥ì†Œë“¤ì˜ í‰ê·  ì¤‘ì‹¬ì  ê³„ì‚°í•˜ì—¬ ìµœì  ìœ„ì¹˜ ì„ ì •
- **ëŒ€ì¤‘êµí†µ ì ‘ê·¼ì„±**:
  - ì§€í•˜ì² ì—­ ë„ë³´ 5-10ë¶„ ì´ë‚´ (ìµœëŒ€ 15ë¶„)
  - ë²„ìŠ¤ ì •ë¥˜ìž¥ ë„ë³´ 5ë¶„ ì´ë‚´
  - ì—­ ê°œìˆ˜: 3ê°œ ì´ìƒ ë…¸ì„  í™˜ìŠ¹ ê°€ëŠ¥í•œ ì—­ ìš°ì„ 
- **êµí†µìˆ˜ë‹¨ ê³ ë ¤**:
  - TRANSIT(ê¸°ë³¸ê°’): ëŒ€ì¤‘êµí†µ ì¤‘ì‹¬ì§€ ê·¼ì²˜
  - DRIVE: ì£¼ì°¨ ê°€ëŠ¥í•œ ìˆ™ì†Œ ìš°ì„ 
  - WALK: ê´€ê´‘ì§€ ë°€ì§‘ ì§€ì—­ ë„ë³´ê¶Œ

**3. í•©ë¦¬ì ì¸ ê°€ê²©ëŒ€ ì ìš©**:
- chatì—ì„œ ì¶”ë¡ í•œ ê°€ê²©ëŒ€ë¥¼ ìš°ì„  ì ìš©
- ì—¬í–‰ ìŠ¤íƒ€ì¼ ë°˜ì˜:
  - "ì•Œì°¨ê²Œ", "ë§Žì´ ë³´ê³  ì‹¶ì–´" â†’ ì €~ì¤‘ê°€ (ì´ë™ ë¹„ìš© ê³ ë ¤)
  - "ì—¬ìœ ë¡­ê²Œ", "íŽ¸í•˜ê²Œ" â†’ ì¤‘ìƒê°€ (íŽ¸ì˜ì„± ìš°ì„ )
  - "ë°°ë‚­ì—¬í–‰", "ë°±íŒ¨í‚¹" â†’ ì €ê°€ (ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤/í˜¸ìŠ¤í…”)
  - "ê°€ì¡±ì—¬í–‰", "ì•„ì´ì™€ í•¨ê»˜" â†’ ì¤‘~ì¤‘ìƒê°€ (íŽ¸ì˜ ì‹œì„¤ ì¤‘ìš”)
  - "ì‹ í˜¼ì—¬í–‰", "ê¸°ë…ì¼" â†’ ì¤‘ìƒ~ê³ ê°€ (í’ˆì§ˆ ìš°ì„ )

**4. Google Mapsë¡œ ìˆ™ì†Œ ê²€ìƒ‰ ë° ì •ë³´ ì¡°íšŒ** (í•„ìˆ˜):
- **ê²€ìƒ‰ ì¿¼ë¦¬ ìž‘ì„±**:
  - ê¸°ë³¸ í˜•ì‹: "[ì§€ì—­ëª…] [ìˆ™ì†Œ ìœ í˜•]" (ì˜ˆ: "Namba Osaka hotel")
  - ê°€ê²©ëŒ€ í•„í„°: "budget", "mid-range", "luxury" ì¶”ê°€
  - ì˜ˆì‹œ:
    - "Namba Osaka budget hotel"
    - "Shinsaibashi guesthouse"
    - "Umeda business hotel"
- **í‰ì  ë° ë¦¬ë·° ê¸°ì¤€**:
  - í‰ì : 4.0 ì´ìƒ ê¶Œìž¥ (3.8 ì´ìƒ í—ˆìš©)
  - ë¦¬ë·° ìˆ˜: 100ê°œ ì´ìƒ ê¶Œìž¥ (ì‹ ë¢°ë„ í™•ë³´)
  - ìµœì‹  ë¦¬ë·° í™•ì¸ (1ë…„ ì´ë‚´)
- **í•„ìˆ˜ ì¡°íšŒ ì •ë³´**:
  - ì •í™•í•œ ì¢Œí‘œ(latitude, longitude): ì†Œìˆ˜ì  6ìžë¦¬
  - ì •í™•í•œ ì£¼ì†Œ(name_address): "ìˆ™ì†Œëª… + í•œì¹¸ ê³µë°± + ìƒì„¸ ì£¼ì†Œ"
  - ì£¼ë³€ ì‹œì„¤: íŽ¸ì˜ì , ì‹ë‹¹, ì§€í•˜ì² ì—­ ê±°ë¦¬ í™•ì¸
- **ê²€ì¦ ì ˆì°¨**:
  - ì¡°íšŒëœ ì¢Œí‘œê°€ ì—¬í–‰ êµ­ê°€/ë„ì‹œ ë²”ìœ„ ë‚´ì¸ì§€ í™•ì¸
  - ì£¼ì†Œì— êµ­ê°€/ë„ì‹œëª…ì´ í¬í•¨ë˜ì–´ ìžˆëŠ”ì§€ í™•ì¸
  - ìˆ™ì†Œ íƒ€ìž…(lodging)ì´ ë§žëŠ”ì§€ í™•ì¸

**5. ì¼ì •ì— í¬í•¨**:
- ì¶”ì²œí•œ ìˆ™ì†Œë¥¼ **place_tag=HOME**ìœ¼ë¡œ ì„¤ì •
- ê° dayì˜ **ì²« ë²ˆì§¸ visit**ê³¼ **ë§ˆì§€ë§‰ visit**ì— í¬í•¨
- display_name: ìˆ™ì†Œëª…ë§Œ (ì˜ˆ: "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´")
- name_address: ìˆ™ì†Œëª… + ì£¼ì†Œ (ì˜ˆ: "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´ 2-5-15 Shinsaibashi-suji, Chuo Ward, Osaka, 542-0085 ì¼ë³¸")
- arrival/departure ì‹œê°„: ì ì ˆí•œ ì¶œë°œ/ê·€ê°€ ì‹œê°„ ì„¤ì •
  - ì¶œë°œ: 09:00-10:00 (ì²« ê´€ê´‘ì§€ ê°œìž¥ ì‹œê°„ ê³ ë ¤)
  - ê·€ê°€: 20:00-22:00 (í•˜ë£¨ ì¼ì • ì¢…ë£Œ ì‹œê°„)

**6. ì¶”ì²œ ì´ìœ  ê¸°ë¡** (ë‚´ë¶€ ë¡œì§ìš©):
- GeminiëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ì¶”ì²œ ì´ìœ ë¥¼ íŒë‹¨í•˜ë˜, **ì‘ë‹µ JSONì—ëŠ” í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”**
- íŒë‹¨ ê¸°ì¤€:
  - ìœ„ì¹˜ ì ìˆ˜: ê´€ê´‘ì§€ í‰ê·  ê±°ë¦¬, êµí†µ ì ‘ê·¼ì„±
  - ê°€ê²© ì ìˆ˜: ì˜ˆì‚° ë¶€í•©ë„
  - í‰ì  ì ìˆ˜: ë¦¬ë·° í‰ì  ë° ê°œìˆ˜
  - íŽ¸ì˜ ì ìˆ˜: ì£¼ë³€ ì‹œì„¤ ë° íŽ¸ì˜ ì‹œì„¤
- ì´ ì •ë³´ëŠ” ìµœì  ìˆ™ì†Œ ì„ ì •ì—ë§Œ ì‚¬ìš©í•˜ê³  ì‘ë‹µì— ë¯¸í¬í•¨

**ì˜ˆì‹œ 1**:
- ìš”ì²­: "ì˜¤ì‚¬ì¹´ ì—¬í–‰, ë‚œë°” ìª½ì´ ì¢‹ì„ê¹Œ?, ê°€ì„±ë¹„ ì¢‹ì€ ê³³ìœ¼ë¡œ"
- ë¶„ì„:
  - ìœ„ì¹˜: ë‚œë°” ëª…ì‹œ â†’ ë‚œë°”/ë„í†¤ë³´ë¦¬ ì§€ì—­
  - ê°€ê²©ëŒ€: "ê°€ì„±ë¹„" â†’ ì¤‘ê°€(â‚©50,000-100,000/ë°•)
  - ìˆ™ì†Œ ìœ í˜•: ë¯¸ëª…ì‹œ â†’ ë¹„ì¦ˆë‹ˆìŠ¤ í˜¸í…” ë˜ëŠ” ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤
- Google Maps ê²€ìƒ‰: "Namba Osaka budget hotel" ë˜ëŠ” "Namba guesthouse"
- í›„ë³´ í•„í„°: í‰ì  4.0+, ë¦¬ë·° 100+, ë‚œë°”ì—­ ë„ë³´ 10ë¶„ ì´ë‚´
- ì„ íƒ: í‰ì , ìœ„ì¹˜, ê°€ê²©ì„ ì¢…í•©í•˜ì—¬ ìµœì  ìˆ™ì†Œ ì„ íƒ
  - ì˜ˆ: "ë‚œë°” ì˜¤ë¦¬ì—”íƒˆ í˜¸í…”" (í‰ì  4.2, ë¦¬ë·° 523ê°œ, ë‚œë°”ì—­ ë„ë³´ 5ë¶„)
- ì¼ì • í¬í•¨: Day 1-3 ëª¨ë‘ ì²«/ë§ˆì§€ë§‰ visitìœ¼ë¡œ í•´ë‹¹ ìˆ™ì†Œ í¬í•¨

**ì˜ˆì‹œ 2**:
- ìš”ì²­: "ë„ì¿„ 3ì¼ ì—¬í–‰, ì•„ì‚¬ì¿ ì‚¬ ë§Žì´ ê°€ê³  ì‹¶ì–´ìš”, ì¡°ì‹ í¬í•¨ í˜¸í…”"
- ë¶„ì„:
  - ìœ„ì¹˜: ì•„ì‚¬ì¿ ì‚¬ ì–¸ê¸‰ ë§ŽìŒ â†’ ì•„ì‚¬ì¿ ì‚¬ ì§€ì—­ ì¤‘ì‹¬
  - ê°€ê²©ëŒ€: ë¯¸ëª…ì‹œ â†’ ì¤‘ê°€(ê°€ì„±ë¹„) ê¸°ë³¸ê°’
  - ìˆ™ì†Œ ìœ í˜•: "í˜¸í…”", "ì¡°ì‹ í¬í•¨"
- Google Maps ê²€ìƒ‰: "Asakusa Tokyo hotel breakfast"
- í›„ë³´ í•„í„°: í‰ì  4.0+, ì¡°ì‹ ì œê³µ, ì•„ì‚¬ì¿ ì‚¬ì—­ ë„ë³´ 10ë¶„ ì´ë‚´
- ì„ íƒ: "ë¦¬ì¹˜ëª¬ë“œ í˜¸í…” í”„ë¦¬ë¯¸ì–´ ì•„ì‚¬ì¿ ì‚¬" (í‰ì  4.3, ì¡°ì‹ í¬í•¨, ì—­ ë„ë³´ 3ë¶„)
- ì¼ì • í¬í•¨: Day 1-3 ëª¨ë‘ ì²«/ë§ˆì§€ë§‰ visitìœ¼ë¡œ í•´ë‹¹ ìˆ™ì†Œ í¬í•¨

---

## Google Maps Grounding í™œìš© ê°€ì´ë“œ

### í•„ìˆ˜ ì •ë³´ ì¡°íšŒ

Google Maps Grounding Toolì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒ ì •ë³´ë¥¼ **ë°˜ë“œì‹œ** ì¡°íšŒí•˜ì„¸ìš”:

**1. ì •í™•í•œ ì¢Œí‘œ (latitude, longitude)**:
- ì†Œìˆ˜ì  6ìžë¦¬ê¹Œì§€ ì •í™•í•œ ì¢Œí‘œ ì‚¬ìš©
- ì˜ˆ: latitude: 34.687315, longitude: 135.526199
- ëª¨ë“  ìž¥ì†Œì— ëŒ€í•´ í•„ìˆ˜

**2. ìƒì„¸ ì£¼ì†Œ (name_address í•„ë“œ)**:
- í˜•ì‹: "ìž¥ì†Œëª… + í•œì¹¸ ê³µë°± + ìƒì„¸ ì£¼ì†Œ"
- ì˜ˆ: "ì˜¤ì‚¬ì¹´ ì„± 1-1 Osakajo, Chuo Ward, Osaka, 540-0002 ì¼ë³¸"
- ì˜ˆ: "ìœ ë‹ˆë²„ì„¤ ìŠ¤íŠœë””ì˜¤ ìž¬íŒ¬ 2 Chome-1-33 Sakurajima, Konohana Ward, Osaka, 554-0031 ì¼ë³¸"
- **ì¤‘ìš”**: ìž¥ì†Œëª…ê³¼ ì£¼ì†Œ ì‚¬ì´ì— í•œì¹¸ ê³µë°± í•„ìˆ˜

**3. ìš´ì˜ì‹œê°„ (opening hours)**:
- ê° ìž¥ì†Œì˜ ìš”ì¼ë³„ ìš´ì˜ì‹œê°„ í™•ì¸
- íœ´ë¬´ì¼(closed) ë°˜ë“œì‹œ í™•ì¸
- ì˜ˆ: Monday: 09:00-17:00, Tuesday: Closed
- í•´ë‹¹ ìš”ì¼ì— íœ´ë¬´ì´ë©´ ê·¸ ë‚ ì§œì— ë°©ë¬¸í•˜ì§€ ë§ ê²ƒ

**4. ì´ë™ì‹œê°„ (travel time)**:
- ì‹¤ì œ ë„ë¡œ/ëŒ€ì¤‘êµí†µ ê¸°ë°˜ ì´ë™ì‹œê°„ ê³„ì‚°
- êµí†µìˆ˜ë‹¨(DRIVE/TRANSIT/WALK/BICYCLE)ì— ë”°ë¼ ë‹¤ë¦„
- ì˜ˆ: A ìž¥ì†Œ â†’ B ìž¥ì†Œ (TRANSIT, 30ë¶„)
- ì‹¤ì‹œê°„ êµí†µ ìƒí™©, ëŒ€ì¤‘êµí†µ ë°°ì°¨ ê°„ê²© ê³ ë ¤

### êµí†µìˆ˜ë‹¨ ë§¤í•‘

1-Dì—ì„œ ì¶”ë¡ í•œ ì´ë™ ìˆ˜ë‹¨ì„ Google Maps êµí†µìˆ˜ë‹¨ìœ¼ë¡œ ë§¤í•‘í•˜ì„¸ìš”:

**DRIVE** (ìžë™ì°¨):
- chatì—ì„œ "ë Œí„°ì¹´", "ìžë™ì°¨", "ì°¨ ë¹Œë ¤ì„œ", "ìš´ì „" ì–¸ê¸‰ ì‹œ
- ìžë™ì°¨ ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„ ê³„ì‚°
- ì£¼ì°¨ ì‹œê°„ ì¶”ê°€ ê³ ë ¤ (5-10ë¶„)

**TRANSIT** (ëŒ€ì¤‘êµí†µ) - **ê¸°ë³¸ê°’**:
- chatì—ì„œ "ëŒ€ì¤‘êµí†µ", "ë²„ìŠ¤", "ì§€í•˜ì² " ì–¸ê¸‰ ì‹œ
- ë˜ëŠ” ì´ë™ ìˆ˜ë‹¨ ì–¸ê¸‰ì´ ì—†ì„ ê²½ìš°
- ëŒ€ì¤‘êµí†µ ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„ ê³„ì‚° (í™˜ìŠ¹ í¬í•¨)
- ë°°ì°¨ ê°„ê²©, ë„ë³´ ì´ë™ ì‹œê°„ í¬í•¨

**WALK** (ë„ë³´):
- chatì—ì„œ "ê±·ê¸°", "ë„ë³´", "ì‚°ì±…" ì–¸ê¸‰ ì‹œ
- ë„ë³´ ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„ ê³„ì‚°
- ê²½ì‚¬, íš¡ë‹¨ë³´ë„ ë“± ê³ ë ¤

**BICYCLE** (ìžì „ê±°):
- chatì—ì„œ "ìžì „ê±°" ì–¸ê¸‰ ì‹œ
- ìžì „ê±° ê²½ë¡œ ê¸°ë°˜ ì´ë™ì‹œê°„ ê³„ì‚°

### Google Maps ì‚¬ìš© ì˜ˆì‹œ

**ìž¥ì†Œ ì •ë³´ ì¡°íšŒ**:
```
Query: "ì˜¤ì‚¬ì¹´ ì„±"
Result:
- display_name: "ì˜¤ì‚¬ì¹´ ì„±"
- name_address: "ì˜¤ì‚¬ì¹´ ì„± 1-1 Osakajo, Chuo Ward, Osaka, 540-0002 ì¼ë³¸"
- latitude: 34.687315
- longitude: 135.526199
- opening_hours:
  - Monday: 09:00-17:00
  - Tuesday: 09:00-17:00
  - Wednesday: 09:00-17:00
  - ...
```

**ì´ë™ì‹œê°„ ê³„ì‚°**:
```
From: ì˜¤ì‚¬ì¹´ ì„± (34.687315, 135.526199)
To: ë„í†¤ë³´ë¦¬ (34.668736, 135.501297)
Mode: TRANSIT
Result: 30ë¶„ (ì§€í•˜ì²  + ë„ë³´)
```

**ìˆ™ì†Œ ê²€ìƒ‰**:
```
Query: "Namba Osaka hotel"
Filter: rating >= 4.0, type = lodging
Result:
- display_name: "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´"
- name_address: "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´ 2-5-15 Shinsaibashi-suji, Chuo Ward, Osaka, 542-0085 ì¼ë³¸"
- latitude: 34.672042
- longitude: 135.502014
- rating: 4.2
- user_ratings_total: 1523
```

---

## ì¶œë ¥ í˜•ì‹ (Output Format)

### JSON êµ¬ì¡°

**ì¤‘ìš”**: ë‹¤ìŒ JSON êµ¬ì¡°ë¥¼ ì •í™•ížˆ ë”°ë¥´ì„¸ìš”. budgetì€ itinerary ë°°ì—´ ë°–ì— ìžˆì–´ì•¼ í•©ë‹ˆë‹¤!

```json
{{
  "itinerary": [
    {{
      "day": 1,
      "visits": [
        {{
          "order": 1,
          "display_name": "ì˜¤ì‚¬ì¹´ ì„±",
          "name_address": "ì˜¤ì‚¬ì¹´ ì„± 1-1 Osakajo, Chuo Ward, Osaka, 540-0002 ì¼ë³¸",
          "place_tag": "TOURIST_SPOT",
          "latitude": 34.687315,
          "longitude": 135.526199,
          "arrival": "09:00",
          "departure": "11:30",
          "travel_time": 30
        }},
        {{
          "order": 2,
          "display_name": "ë„í†¤ë³´ë¦¬",
          "name_address": "ë„í†¤ë³´ë¦¬ Dotonbori, Chuo Ward, Osaka, 542-0071 ì¼ë³¸",
          "place_tag": "TOURIST_SPOT",
          "latitude": 34.668736,
          "longitude": 135.501297,
          "arrival": "12:00",
          "departure": "14:00",
          "travel_time": 0
        }}
      ]
    }},
    {{
      "day": 2,
      "visits": [...]
    }}
  ],
  "budget": 500000
}}
```

### JSON í•„ë“œ ìƒì„¸ ì„¤ëª…

**ìµœìƒìœ„ êµ¬ì¡°**:
- `itinerary` (ë°°ì—´): ëª¨ë“  ì¼ì • ì •ë³´ë¥¼ ë‹´ì€ ë°°ì—´
- `budget` (ì •ìˆ˜): 1ì¸ë‹¹ ì˜ˆìƒ ì˜ˆì‚° (ì›í™” ê¸°ì¤€) - **itinerary ë°°ì—´ ë°–ì— ìœ„ì¹˜**

**day ê°ì²´ (itinerary ë°°ì—´ì˜ ê° ìš”ì†Œ)**:
- `day` (ì •ìˆ˜): 1ë¶€í„° ì‹œìž‘í•˜ëŠ” ì¼ì°¨ ë²ˆí˜¸ (1, 2, 3, ...)
- `visits` (ë°°ì—´): í•´ë‹¹ ë‚ ì§œì˜ ë°©ë¬¸ ìž¥ì†Œë“¤

**visit ê°ì²´ (visits ë°°ì—´ì˜ ê° ìš”ì†Œ)**:

1. **order** (ì •ìˆ˜):
   - ê° day ë‚´ì—ì„œ 1ë¶€í„° ì‹œìž‘í•˜ëŠ” ë°©ë¬¸ ìˆœì„œ
   - ì˜ˆ: Visit 1, Visit 2, Visit 3, ...

2. **display_name** (ë¬¸ìžì—´):
   - í‘œì‹œìš© ìž¥ì†Œëª…ë§Œ (ì£¼ì†Œ ì œì™¸)
   - í˜•ì‹: "ìž¥ì†Œëª…"
   - ì˜ˆì‹œ: "ì˜¤ì‚¬ì¹´ ì„±", "ìœ ë‹ˆë²„ì„¤ ìŠ¤íŠœë””ì˜¤ ìž¬íŒ¬", "ë„í†¤ë³´ë¦¬"
   - ê°„ê²°í•˜ê³  ëª…í™•í•œ ì´ë¦„ ì‚¬ìš©

3. **name_address** (ë¬¸ìžì—´):
   - ìž¥ì†Œëª… + í•œì¹¸ ê³µë°± + ìƒì„¸ ì£¼ì†Œ
   - í˜•ì‹: "ìž¥ì†Œëª… ì£¼ì†Œ"
   - ì˜ˆì‹œ: "ìœ ë‹ˆë²„ì„¤ ìŠ¤íŠœë””ì˜¤ ìž¬íŒ¬ 2 Chome-1-33 Sakurajima, Konohana Ward, Osaka, 554-0031 ì¼ë³¸"
   - ì˜ˆì‹œ: "ì˜¤ì‚¬ì¹´ ì„± 1-1 Osakajo, Chuo Ward, Osaka, 540-0002 ì¼ë³¸"
   - **ë°˜ë“œì‹œ ìž¥ì†Œëª…ê³¼ ì£¼ì†Œ ì‚¬ì´ì— í•œì¹¸ ê³µë°±ì„ ë„£ìœ¼ì„¸ìš”**

4. **place_tag** (ë¬¸ìžì—´, ëŒ€ë¬¸ìž):
   - ê°€ëŠ¥í•œ ê°’: "TOURIST_SPOT", "HOME", "RESTAURANT", "CAFE", "OTHER"
   - í• ë‹¹ ê·œì¹™:
     - **TOURIST_SPOT**: ê´€ê´‘ì§€, ë°•ë¬¼ê´€, í…Œë§ˆíŒŒí¬, ì‚¬ì›, ì„±, ì „ë§ëŒ€ ë“±
     - **HOME**: í˜¸í…”, ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤, ìˆ™ì†Œ, ë¦¬ì¡°íŠ¸ ë“±
     - **RESTAURANT**: ì‹ë‹¹, ë ˆìŠ¤í† ëž‘, ìŒì‹ì , ì‹œìž¥ (ìŒì‹ ì¤‘ì‹¬) ë“±
     - **CAFE**: ì¹´íŽ˜, ë””ì €íŠ¸ ê°€ê²Œ, ë² ì´ì»¤ë¦¬ ë“±
     - **OTHER**: ìœ„ ë¶„ë¥˜ì— ë§žì§€ ì•ŠëŠ” ê²½ìš° (ê³µí•­, ì—­ ë“±)

5. **latitude, longitude** (ì†Œìˆ˜):
   - ì†Œìˆ˜ì  í˜•ì‹ì˜ ì •í™•í•œ ì¢Œí‘œ (ì†Œìˆ˜ì  6ìžë¦¬ê¹Œì§€)
   - ì˜ˆ: latitude: 34.687315, longitude: 135.526199
   - Google Mapsì—ì„œ ì¡°íšŒí•œ ì •í™•í•œ ì¢Œí‘œ ì‚¬ìš©

6. **arrival** (ë¬¸ìžì—´) - **í•„ìˆ˜ í•„ë“œ**:
   - í•´ë‹¹ ìž¥ì†Œì— ë„ì°©í•˜ëŠ” ì‹œê°„
   - 24ì‹œê°„ í˜•ì‹ "HH:MM" (ì˜ˆ: "09:00", "14:30")
   - **ëª¨ë“  visitì— ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•¨**
   - ì²« ë²ˆì§¸ visit: í•˜ë£¨ ì¼ì • ì‹œìž‘ ì‹œê°„ (ì˜ˆ: 09:00)
   - ì´í›„ visit: ì´ì „ ìž¥ì†Œì˜ departure + travel_timeìœ¼ë¡œ ê³„ì‚°

7. **departure** (ë¬¸ìžì—´) - **í•„ìˆ˜ í•„ë“œ**:
   - í•´ë‹¹ ìž¥ì†Œì—ì„œ ë– ë‚˜ëŠ” ì‹œê°„
   - 24ì‹œê°„ í˜•ì‹ "HH:MM" (ì˜ˆ: "11:30", "20:00")
   - **ëª¨ë“  visitì— ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•¨**
   - arrival + í•´ë‹¹ ìž¥ì†Œ ì²´ë¥˜ì‹œê°„ìœ¼ë¡œ ê³„ì‚°
   - ì²´ë¥˜ì‹œê°„ì€ 3-Aì˜ ê°€ì´ë“œë¼ì¸ì„ ì°¸ê³ í•˜ì„¸ìš”
   - ì˜ˆ: ì˜¤ì‚¬ì¹´ ì„± arrival "09:00" â†’ 2.5ì‹œê°„ ì²´ë¥˜ â†’ departure "11:30"

8. **travel_time** (ì •ìˆ˜):
   - ë‹¤ìŒ ìž¥ì†Œë¡œ ê°€ëŠ” ì´ë™ì‹œê°„ (ë¶„ ë‹¨ìœ„)
   - **ì²« ë²ˆì§¸ visit**: ì²« ë²ˆì§¸ ìž¥ì†Œ â†’ ë‘ ë²ˆì§¸ ìž¥ì†Œ ì´ë™ì‹œê°„
   - **ì¤‘ê°„ visit**: í˜„ìž¬ ìž¥ì†Œ â†’ ë‹¤ìŒ ìž¥ì†Œ ì´ë™ì‹œê°„
   - **ë§ˆì§€ë§‰ visit**: 0 (ë‹¤ìŒ ìž¥ì†Œê°€ ì—†ìœ¼ë¯€ë¡œ)
   - ì˜ˆ: Visit 1 departure "11:30", travel_time 30 â†’ Visit 2 arrival "12:00"

### travel_time í•„ë“œ ì •ì˜ (ë§¤ìš° ì¤‘ìš”)

**ì¤‘ìš”**: travel_timeì€ ì°¸ê³ ìš©ìœ¼ë¡œ ìƒì„±í•˜ë©°, ì‹¤ì œê°’ì€ ì¼ì • ìƒì„± í›„ Routes APIë¡œ ìžë™ ëŒ€ì²´ë©ë‹ˆë‹¤.

**ê³„ì‚° ê·œì¹™**:
- **ì²« ë²ˆì§¸ ë°©ë¬¸ì˜ travel_time**: ì²« ë²ˆì§¸ ìž¥ì†Œ â†’ ë‘ ë²ˆì§¸ ìž¥ì†Œ ì´ë™ì‹œê°„
- **ì¤‘ê°„ ë°©ë¬¸ì˜ travel_time**: í˜„ìž¬ ìž¥ì†Œ â†’ ë‹¤ìŒ ìž¥ì†Œ ì´ë™ì‹œê°„
- **ë§ˆì§€ë§‰ ë°©ë¬¸ì˜ travel_time**: 0

**ê³„ì‚° ê³µì‹**:
```
visit[i+1].arrival = visit[i].departure + visit[i].travel_time
```

**ì˜ˆì‹œ** (3ê°œ visit):
```json
{{
  "visits": [
    {{
      "order": 1,
      "display_name": "ì˜¤ì‚¬ì¹´ ì„±",
      "departure": "11:30",
      "travel_time": 30   // ì˜¤ì‚¬ì¹´ ì„± â†’ ë„í†¤ë³´ë¦¬ (30ë¶„)
    }},
    {{
      "order": 2,
      "display_name": "ë„í†¤ë³´ë¦¬",
      "arrival": "12:00",  // 11:30 + 30ë¶„
      "departure": "14:00",
      "travel_time": 20   // ë„í†¤ë³´ë¦¬ â†’ ë‚œë°” (20ë¶„)
    }},
    {{
      "order": 3,
      "display_name": "ë‚œë°”",
      "arrival": "14:20",  // 14:00 + 20ë¶„
      "departure": "16:00",
      "travel_time": 0    // ë§ˆì§€ë§‰ ë°©ë¬¸
    }}
  ]
}}
```

### ì˜ˆì‹œ JSON (2ì¼ ì¼ì •, HOME í¬í•¨)

```json
{{
  "itinerary": [
    {{
      "day": 1,
      "visits": [
        {{
          "order": 1,
          "display_name": "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´",
          "name_address": "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´ 2-5-15 Shinsaibashi-suji, Chuo Ward, Osaka, 542-0085 ì¼ë³¸",
          "place_tag": "HOME",
          "latitude": 34.672042,
          "longitude": 135.502014,
          "arrival": "09:00",
          "departure": "09:30",
          "travel_time": 20
        }},
        {{
          "order": 2,
          "display_name": "ì˜¤ì‚¬ì¹´ ì„±",
          "name_address": "ì˜¤ì‚¬ì¹´ ì„± 1-1 Osakajo, Chuo Ward, Osaka, 540-0002 ì¼ë³¸",
          "place_tag": "TOURIST_SPOT",
          "latitude": 34.687315,
          "longitude": 135.526199,
          "arrival": "09:50",
          "departure": "12:20",
          "travel_time": 30
        }},
        {{
          "order": 3,
          "display_name": "ì´ì¹˜ëž€ ë¼ë©˜ ë„í†¤ë³´ë¦¬ì ",
          "name_address": "ì´ì¹˜ëž€ ë¼ë©˜ ë„í†¤ë³´ë¦¬ì  1-4-16 Dotonbori, Chuo Ward, Osaka, 542-0071 ì¼ë³¸",
          "place_tag": "RESTAURANT",
          "latitude": 34.668975,
          "longitude": 135.501123,
          "arrival": "12:50",
          "departure": "14:00",
          "travel_time": 15
        }},
        {{
          "order": 4,
          "display_name": "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´",
          "name_address": "í¬ë¡œìŠ¤ í˜¸í…” ì˜¤ì‚¬ì¹´ 2-5-15 Shinsaibashi-suji, Chuo Ward, Osaka, 542-0085 ì¼ë³¸",
          "place_tag": "HOME",
          "latitude": 34.672042,
          "longitude": 135.502014,
          "arrival": "14:15",
          "departure": "14:15",
          "travel_time": 0
        }}
      ]
    }},
    {{
      "day": 2,
      "visits": [...]
    }}
  ],
  "travel_mode": "TRANSIT",
  "budget": 450000
}}
```

### í•„ìˆ˜ ì¤€ìˆ˜ ì‚¬í•­

1. **ìˆœìˆ˜ JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”**:
   - ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡(```)ì´ë‚˜ ì„¤ëª… í…ìŠ¤íŠ¸ ì—†ì´ JSONë§Œ ì¶œë ¥í•˜ì„¸ìš”
   - âŒ ìž˜ëª»ëœ ì˜ˆ: ```json ... ```
   - â­• ì˜¬ë°”ë¥¸ ì˜ˆ: {{"itinerary": [...], "travel_mode": "TRANSIT", "budget": 500000}}

2. **JSON êµ¬ì¡°ë¥¼ ì •í™•ížˆ ì§€í‚¤ì„¸ìš”**:
   - ìµœìƒìœ„ëŠ” ê°ì²´ì´ë©°, "itinerary" ë°°ì—´, "travel_mode" ë¬¸ìžì—´, "budget" ìˆ«ìž ì„¸ ê°œì˜ ì†ì„±ì„ ê°€ì§‘ë‹ˆë‹¤
   - travel_modeì™€ budgetì€ itinerary ë°°ì—´ ë°–ì— ìœ„ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤ (ë°°ì—´ ì•ˆì— ë„£ì§€ ë§ˆì„¸ìš”)

3. **ìœ íš¨í•œ JSON í˜•ì‹**:
   - ì‰¼í‘œ, ì¤‘ê´„í˜¸, ëŒ€ê´„í˜¸ë¥¼ ì •í™•ížˆ ì‚¬ìš©í•˜ì„¸ìš”
   - ë§ˆì§€ë§‰ ìš”ì†Œ ë’¤ì— ì‰¼í‘œë¥¼ ë¶™ì´ì§€ ë§ˆì„¸ìš”
   - ë¬¸ìžì—´ì€ í°ë”°ì˜´í‘œ(")ë¡œ ê°ì‹¸ì„¸ìš”

---

## ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ì‘ë‹µí•˜ê¸° ì „ì— Geminiê°€ ìŠ¤ìŠ¤ë¡œ ê²€ì¦í•  ì‚¬í•­**:

### ðŸ”´ Priority 1 ê²€ì¦ (MANDATORY - ì ˆëŒ€ ìœ„ë°˜ ë¶ˆê°€)
- [ ] **days ê°œìˆ˜ ì •í™•í•œê°€?**
  - len(itinerary) == days
  - ì˜ˆ: days=3ì´ë©´ ì •í™•ížˆ 3ê°œì˜ day ê°ì²´ ìƒì„±
- [ ] **must_visit ëª¨ë‘ í¬í•¨ë˜ì—ˆëŠ”ê°€?**
  - must_visitì˜ ê° ìž¥ì†Œëª…ì´ itineraryì˜ ì–´ëŠ dayì—ë“  display_nameìœ¼ë¡œ ì¡´ìž¬
  - ëª¨ë“  must_visit ìž¥ì†Œê°€ ë¹ ì§ì—†ì´ í¬í•¨ë¨
- [ ] **rule ëª¨ë‘ ì¤€ìˆ˜í–ˆëŠ”ê°€?**
  - ê° ê·œì¹™ì´ ì¼ì •ì— ì •í™•ížˆ ë°˜ì˜ë¨
  - ì‹œê°„ ì œì•½, í™œë™ ìš”êµ¬, ìž¥ì†Œ ìš°ì„ ìˆœìœ„, ì´ë™ ì œì•½ ëª¨ë‘ ì ìš©

### ðŸŸ  Priority 2 ê²€ì¦ (HIGHLY RECOMMENDED - ìµœëŒ€í•œ ì¤€ìˆ˜)
- [ ] **ëª¨ë“  ìš´ì˜ì‹œê°„ ë‚´ ë°©ë¬¸ì¸ê°€?**
  - ê° ë°©ë¬¸ì˜ arrival/departureê°€ ìš´ì˜ì‹œê°„ ë‚´
  - íœ´ë¬´ì¼ì— ë°©ë¬¸í•˜ëŠ” ìž¥ì†Œê°€ ì—†ìŒ
  - Google Mapsì—ì„œ ìš”ì¼ë³„ ìš´ì˜ì‹œê°„ í™•ì¸

### ì œì•½ì‚¬í•­ ê²€ì¦
- [ ] **ìˆ™ì†Œ(HOME) ì¶œë°œ/ê·€ê°€ ì¼ì •ì¸ê°€?**
  - ê° dayì˜ ì²« ë²ˆì§¸ visit: place_tag=HOME
  - ê° dayì˜ ë§ˆì§€ë§‰ visit: place_tag=HOME
  - ì˜ˆì™¸: ê·œì¹™(rule)ì— ë‹¤ë¥¸ íŒ¨í„´ ëª…ì‹œëœ ê²½ìš°
- [ ] **í•˜ë£¨ 10-12ì‹œê°„ ì¼ì •ì¸ê°€?**
  - ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë£¨ ì¼ì •ì€ 10-12ì‹œê°„
  - ì˜ˆì™¸: chatì—ì„œ "ì—¬ìœ ë¡­ê²Œ" (8-10ì‹œê°„) ë˜ëŠ” "ì•Œì°¨ê²Œ" (12-14ì‹œê°„) ì–¸ê¸‰ ì‹œ

### JSON í˜•ì‹ ê²€ì¦
- [ ] **ìˆœìˆ˜ JSONë§Œ ì¶œë ¥í–ˆëŠ”ê°€?**
  - ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡(```) ì—†ìŒ
  - ì„¤ëª… í…ìŠ¤íŠ¸ ì—†ìŒ
  - {{ "itinerary": [...], "travel_mode": "TRANSIT", "budget": 500000 }} í˜•ì‹
- [ ] **travel_modeì™€ budgetì´ itinerary ë°°ì—´ ë°–ì— ìžˆëŠ”ê°€?**
  - ìµœìƒìœ„ ê°ì²´: {{ "itinerary": [...], "travel_mode": "TRANSIT", "budget": ìˆ«ìž }}
  - travel_modeì™€ budgetì´ ë°°ì—´ ì•ˆì— ë“¤ì–´ê°€ ìžˆìœ¼ë©´ ì•ˆ ë¨
- [ ] **ëª¨ë“  visitì— arrivalì´ í¬í•¨ë˜ì–´ ìžˆëŠ”ê°€?**
  - ëª¨ë“  visit ê°ì²´ì— "arrival" í•„ë“œê°€ ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•¨ (HH:MM í˜•ì‹)
  - ëª¨ë“  visit ê°ì²´ì— "departure" í•„ë“œê°€ ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•¨ (HH:MM í˜•ì‹)
  - ì˜ˆ: "arrival": "09:00", "departure": "11:30"

---

## ìµœì¢… ì§€ì¹¨

### ì‘ë‹µ ì „ ìµœì¢… í™•ì¸

1. **ìœ„ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ëª¨ë‘ í™•ì¸í–ˆëŠ”ê°€?**
   - ðŸ”´ Priority 1ì€ 100% ì¤€ìˆ˜
   - ðŸŸ  Priority 2ëŠ” ìµœëŒ€í•œ ì¤€ìˆ˜ (90%+)
   - ì œì•½ì‚¬í•­ ë° JSON í˜•ì‹ ê²€ì¦ ì™„ë£Œ

2. **ìˆœìˆ˜ JSONë§Œ ì¶œë ¥í•˜ëŠ”ê°€?**
   - âŒ ```json {{ ... }} ```
   - â­• {{"itinerary": [...], "travel_mode": "TRANSIT", "budget": 500000}}

3. **ëª¨ë“  í•„ë“œê°€ ì˜¬ë°”ë¥´ê²Œ ì±„ì›Œì¡ŒëŠ”ê°€?**
   - ëª¨ë“  ìž¥ì†Œì— Google Mapsë¡œ ì¡°íšŒí•œ ì •í™•í•œ ì¢Œí‘œ, ì£¼ì†Œ
   - **ëª¨ë“  visitì— arrival í•„ë“œê°€ í¬í•¨ë˜ì–´ ìžˆê³  "HH:MM" í˜•ì‹ì¸ê°€?**
   - **ëª¨ë“  visitì— departure í•„ë“œê°€ í¬í•¨ë˜ì–´ ìžˆê³  "HH:MM" í˜•ì‹ì¸ê°€?**
   - ëª¨ë“  travel_timeì´ ì˜¬ë°”ë¥´ê²Œ ê³„ì‚°ë¨

### ì‘ë‹µ ìƒì„±

ìœ„ ëª¨ë“  ê²€ì¦ì„ í†µê³¼í–ˆë‹¤ë©´, ìˆœìˆ˜ JSONë§Œ ì¶œë ¥í•˜ì„¸ìš”.

---
"""

    return prompt


def create_validation_feedback_prompt(
    request: ItineraryRequest2,
    validation_results: Dict
) -> str:
    """
    Generate feedback prompt for retry attempts when validation fails.

    This prompt is appended to the chat field to guide Gemini in fixing
    validation violations (must_visit, days, operating_hours).

    Args:
        request: Original request object
        validation_results: Dict containing validation failure details
            from _validate_response() method

    Returns:
        str: Feedback message to append to chat

    Example:
        >>> validation_results = {
        ...     "must_visit": {"is_valid": False, "missing": ["ìœ ë‹ˆë²„ì„¤"]},
        ...     "days": {"is_valid": False, "actual": 2, "expected": 3}
        ... }
        >>> feedback = create_validation_feedback_prompt(request, validation_results)
        >>> # Append to request.chat for retry
    """
    feedback = ["âš ï¸ ì´ì „ ì‹œë„ì—ì„œ ë‹¤ìŒ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ìˆ˜ì •í•´ì£¼ì„¸ìš”:"]

    # Must-visit violations
    if not validation_results.get("must_visit", {}).get("is_valid", True):
        missing = validation_results["must_visit"].get("missing", [])
        if missing:
            feedback.append(
                f"ðŸ”´ ëˆ„ë½ëœ must_visit ìž¥ì†Œ: {', '.join(missing)} "
                f"â†’ ì´ ìž¥ì†Œë“¤ì„ ë°˜ë“œì‹œ ì¼ì •ì— í¬í•¨ì‹œì¼œì•¼ í•©ë‹ˆë‹¤!"
            )

    # Days count violations
    if not validation_results.get("days", {}).get("is_valid", True):
        actual = validation_results["days"].get("actual", 0)
        expected = validation_results["days"].get("expected", 0)
        feedback.append(
            f"ðŸ”´ ì¼ìˆ˜ ë¶ˆì¼ì¹˜: {actual}ì¼ ìƒì„±ë¨ (ì˜ˆìƒ: {expected}ì¼) "
            f"â†’ ì •í™•ížˆ {expected}ê°œì˜ dayë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤!"
        )

    # Operating hours violations
    if not validation_results.get("operating_hours", {}).get("is_valid", True):
        violations = validation_results["operating_hours"].get("violations", [])
        if violations:
            violation_details = []
            for v in violations[:3]:  # Max 3 violations shown
                violation_details.append(
                    f"Day {v['day']}: {v['place']} ({v.get('arrival', 'N/A')}-{v.get('departure', 'N/A')})"
                )
            feedback.append(
                f"ðŸ”´ ìš´ì˜ì‹œê°„ ìœ„ë°˜: {', '.join(violation_details)} "
                f"â†’ ì‹¤ì œ ìš´ì˜ì‹œê°„ ë‚´ì— ë°©ë¬¸í•˜ë„ë¡ ì¡°ì •í•˜ì„¸ìš”!"
            )

    return "\n".join(feedback)


# ============================================================================
# HELPER FUNCTIONS (PRIVATE)
# ============================================================================

def _format_date_info(request: ItineraryRequest2) -> List[str]:
    """Format date information with Korean weekdays."""
    weekdays_kr = ["ì›”ìš”ì¼", "í™”ìš”ì¼", "ìˆ˜ìš”ì¼", "ëª©ìš”ì¼", "ê¸ˆìš”ì¼", "í† ìš”ì¼", "ì¼ìš”ì¼"]
    date_info = []
    for day_num in range(request.days):
        current_date = request.start_date + timedelta(days=day_num)
        weekday = weekdays_kr[current_date.weekday()]
        date_info.append(f"Day {day_num + 1}: {current_date.strftime('%Y-%m-%d')} ({weekday})")
    return date_info


def _format_chat(chat: List[str]) -> str:
    """Format chat messages as bullet list."""
    return "\n".join([f"- {msg}" for msg in chat])


def _format_rules(rules: List[str] = None) -> str:
    """Format rules as bullet list or 'none'."""
    if rules:
        return "\n".join([f"- {r}" for r in rules])
    return "ì—†ìŒ"


def _format_must_visit(must_visit: List[str] = None) -> str:
    """Format must-visit places as comma-separated or 'none'."""
    if must_visit:
        return ", ".join(must_visit)
    return "ì—†ìŒ"


def _format_accommodation(places: List) -> str:
    """Extract and format accommodation from places with HOME tag."""
    home_places = [place for place in places if place.place_tag == PlaceTag.HOME]
    if home_places:
        accommodation_text = home_places[0].place_name
        if len(home_places) > 1:
            accommodation_text = ", ".join([place.place_name for place in home_places])
        return accommodation_text
    return "ì—†ìŒ (ì¶”ì²œ í•„ìš”)"


def _format_places(places: List) -> str:
    """Format places list with tags."""
    return "\n".join([f"- {place.place_name} ({place.place_tag.value})" for place in places])
